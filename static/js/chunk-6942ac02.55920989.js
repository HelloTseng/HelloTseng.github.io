(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6942ac02"],{"3a4a":function(e,t,n){},"3e16":function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"s",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"k",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"i",(function(){return D})),n.d(t,"q",(function(){return w})),n.d(t,"p",(function(){return y})),n.d(t,"t",(function(){return O})),n.d(t,"o",(function(){return F})),n.d(t,"u",(function(){return I}));var a=n("b775");function r(e){return Object(a["a"])({url:"/api/Document/GetProfessionnalTitleViewList",method:"get",params:e})}function i(e){return Object(a["a"])({url:"/api/Document/getPersonProfessionnalTitle",method:"get",params:e})}function o(e){return Object(a["a"])({url:"/api/Document/getInstitutions",method:"get",params:e})}function s(e){return Object(a["a"])({url:"/api/Document/DeleteDocumentApprovalProcess",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/api/Document/GetDocumentApprovalProcess",method:"get",params:e})}function u(e){return Object(a["a"])({url:"/api/Document/UpdateDocumentApprovalProcess",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/api/Document/GetDocumentApprovalProcessList",method:"get",params:e})}function d(e){return Object(a["a"])({url:"/api/Document/addDocumentApprovalProcess",method:"post",data:e})}function m(e){return Object(a["a"])({url:"/api/Document/AddDocumentPublish",method:"post",data:e})}function p(e){return Object(a["a"])({url:"/api/Document/GetDocumentPublishViewPageList",method:"get",params:e})}function f(e){return Object(a["a"])({url:"/api/Document/GetDocumentPublish",method:"get",params:e})}function h(e){return Object(a["a"])({url:"/api/Document/UpdateDocumentPublish",method:"post",data:e})}function g(e){return Object(a["a"])({url:"/api/Document/ApproveDocumentPublish",method:"post",data:e})}function b(e){return Object(a["a"])({url:"/api/Document/ConfirmDocumentPublish",method:"post",data:e})}function v(e){return Object(a["a"])({url:"/api/Document/getBookSiteInfoPageList",method:"get",params:e})}function D(e){return Object(a["a"])({url:"/api/Global/GetRegionList",method:"get",params:e})}function w(e){return Object(a["a"])({url:"/api/Document/GetDocumentReceiveViewPageList",method:"get",params:e})}function y(e){return Object(a["a"])({url:"/api/Document/GetDocumentReceiveReadingViewPageList",method:"get",params:e})}function O(e){return Object(a["a"])({url:"/api/Document/Proposed",method:"post",data:e})}function F(e){return Object(a["a"])({url:"/api/Document/GetDocumentReceive",method:"get",params:e})}function I(e){return Object(a["a"])({url:"/api/Document/Reading",method:"post",data:e})}},b7ff:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{directives:[{name:"permission",rawName:"v-permission",value:"create",expression:"'create'"}],staticClass:"search-wrapper",attrs:{flex:"main:right"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:e.tableSize},on:{click:e.doCreate}},[e._v("新增审批流程")])],1),n("table-body",{ref:"mkTable",attrs:{loading:e.tableLoading,columns:e.columns,"table-data":e.tableData,options:e.tableOptions,"index-row":e.indexRow},on:{"cell-data-change":e.handleCellDataChange,"pagination-current-change":e.paginationCurrenChange,"pagination-size-change":e.paginationSizeChange}},[n("el-table-column",{attrs:{slot:"IsEnable",label:"状态",align:"center","min-width":"60"},slot:"IsEnable",scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[a.IsEnable?n("span",{staticClass:"text-green"},[e._v("启用")]):n("span",{staticClass:"text-red"},[e._v("停用")])]}}])}),n("el-table-column",{attrs:{slot:"operate",label:"操作",width:"160",align:"center"},slot:"operate",scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"edit",expression:"'edit'"}],on:{click:function(t){return e.handleEdit(a)}}},[e._v("编辑")]),a.IsEnable?n("switch-status",{directives:[{name:"permission",rawName:"v-permission",value:"disable",expression:"'disable'"}],attrs:{row:a,str:a.ProcessName,"status-key":"IsEnable"},on:{"on-switch":e.handleInnerSwitch}}):n("switch-status",{directives:[{name:"permission",rawName:"v-permission",value:"enable",expression:"'enable'"}],attrs:{row:a,str:a.ProcessName,"status-key":"IsEnable"},on:{"on-switch":e.handleInnerSwitch}}),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"delete",expression:"'delete'"}],attrs:{type:"danger"},on:{click:function(t){return e.handleDelete(a)}}},[e._v("删除")])]}}])})],1),n("el-dialog",{attrs:{title:e.isEdit?"编辑":"新增",visible:e.dialogFormVisible,"destroy-on-close":"","before-close":e.dialogFormClose}},[n("el-form",{ref:"dialogForm",staticClass:"addForm",attrs:{"label-position":"right","label-width":"120px",model:e.dialogForm,rules:e.dialogFormRules,size:e.tableSize}},[n("div",{staticClass:"posiPar"},[n("el-form-item",{attrs:{label:"流程名称",prop:"title"}},[n("el-input",{staticClass:"nameLine",model:{value:e.dialogForm.title,callback:function(t){e.$set(e.dialogForm,"title",t)},expression:"dialogForm.title"}})],1),e._l(e.list,(function(t,a){return n("el-form-item",{key:a,attrs:{label:"审批人"+(a+1),prop:"approvalMan"}},[n("input",{attrs:{id:"order",type:"hidden",name:"order"},domProps:{value:a+5}}),n("el-select",{attrs:{placeholder:"请选择签收单位"},model:{value:t.num,callback:function(n){e.$set(t,"num",n)},expression:"item.num"}},e._l(e.treeData,(function(e,t){return n("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1)],1)})),n("el-form-item",{staticClass:"writeState",attrs:{label:"状态",prop:"state"}},[n("el-switch",{on:{change:e.dialogSwitch},model:{value:e.dialogForm.state,callback:function(t){e.$set(e.dialogForm,"state",t)},expression:"dialogForm.state"}})],1),n("div",{staticClass:"rightDown"},[n("div",{staticClass:"addList",on:{click:e.addForm}},[e._v("增加")]),n("div",{staticClass:"delList",on:{click:e.delForm}},[e._v("删除")])])],2)]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dialogFormConfirm("dialogForm")}}},[e._v("确定")])],1)],1),n("input",{attrs:{type:"hidden"}})],1)},r=[],i=(n("4160"),n("a15b"),n("fb6a"),n("d3b7"),n("159b"),n("5530")),o=n("2f62"),s=n("3e16"),l=n("ed08"),u={data:function(){return{list:[{num:""},{num:""}],formNumArr:[],formNameArr:[],SerialNumber:[],addORupdata:!1,updatasId:"00",searchForm:{search_key:"",state:""},tableLoading:!1,columns:[{title:"流程名称",key:"ProcessName",headerAlign:"center","min-width":"250px"},{title:"创建人",key:"CreateUName",headerAlign:"center","min-width":"140px"},{title:"创建时间",key:"CreateTime",headerAlign:"center","min-width":"200px",formatter:function(e,t,n,a){return Object(l["e"])(e.CreateTime,"{y}-{m}-{d} {h}:{i}:{s}")}},{title:"状态",key:"IsEnable",slot:"IsEnable",align:"center",component:{name:"el-switch",disabled:!0}}],tableData:[],selectionRow:{align:"center"},tableOptions:{border:!0,headerCellClassName:"table-header-bg"},indexRow:{title:"序号",align:"center",width:60},pagination:{currentPage:1,pageSize:10,total:11},isEdit:!1,dialogFormVisible:!1,dialogForm:{title:"",approvalMan:[{num:""},{num:""}],shareMan:[],state:!0},dialogFormRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],approvalMan:[{required:!0,message:"请选择审批人",trigger:"blur"}],shareMan:[{required:!0,message:"请选择审批人",trigger:"blur"}]},treeData:[{value:1,label:"【鉴定点】"},{value:2,label:"主任"}]}}},c={name:"ApprovalList",components:{SwitchStatus:function(){return n.e("chunk-2d0e9431").then(n.bind(null,"8d7f"))},TableBody:function(){return n.e("chunk-79d593e5").then(n.bind(null,"2c21"))}},mixins:[u],computed:Object(i["a"])({},Object(o["c"])({tableSize:function(e){return e.settings.tableSize}})),created:function(){this.doLoad()},methods:{doRefresh:function(){var e=this;Object(s["m"])().then((function(t){t.response.forEach((function(e){e.state?e.state=!0:e.state=!1})),e.tableData=t.response})),Object(s["h"])().then((function(t){for(var n=[],a=0;a<t.response.length;a++){var r={};r.value=t.response[a].PTID,r.label=t.response[a].Name,n.push(r)}e.treeData=n}))},doLoad:function(){this.doRefresh()},searchFormSubmit:function(){},handleInnerSwitch:function(e,t,n,a){var r=this;if("confirm"===t)if(n.confirmButtonLoading=!0,n.confirmButtonText="提交中...",e.IsEnable){var i={approvalProcessID:e.ID,operationType:0};Object(s["d"])(i).then((function(t){a(),e.IsEnable=!e.IsEnable,n.confirmButtonLoading=!1,r.$notify({title:"成功",message:"停用成功",type:"success"})})).catch((function(e){n.confirmButtonLoading=!1,a(e)}))}else{i={approvalProcessID:e.ID,operationType:1};Object(s["d"])(i).then((function(t){a(),e.IsEnable=!e.IsEnable,n.confirmButtonLoading=!1,r.$notify({title:"成功",message:"启用成功",type:"success"})})).catch((function(e){n.confirmButtonLoading=!1,a(e)}))}else a()},handleDelete:function(e){var t=this,n={approvalProcessID:e.ID,operationType:2};this.$confirm("确定要删除这条数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){})).then((function(){Object(s["d"])(n).then((function(e){t.$message({type:"success",message:"删除成功!"}),t.doRefresh()}))}))},searchFormReset:function(){this.searchForm={audit_type:"",receive_type:"",search_key:""}},handleCellDataChange:function(e){e.rowIndex,e.key,e.value,e.row},paginationCurrenChange:function(e){this.pagination.currentPage=e,this.doRefresh()},paginationSizeChange:function(e){this.pagination.pageSize=e,this.doRefresh()},doCreate:function(){this.addORupdata=!1,this.isEdit=!1,this.dialogFormVisible=!0,this.list=[{num:""}],this.updatasId="00",this.dialogForm.title="",this.dialogForm.state=!0},handleEdit:function(e){var t=this;this.addORupdata=!0,this.isEdit=!0,this.dialogFormVisible=!0,this.updatasId=e.ID;var n={};n.processID=e.ID,Object(s["e"])(n).then((function(e){t.dialogForm.title=e.response.ProcessName,t.dialogForm.state=e.response.IsEnable;for(var n=0;n<e.response.Nodes.length;n++){var a={};a.num=e.response.Nodes[n].ProfessionnalTitleID,t.list.push(a)}})),this.list=[]},dialogFormClose:function(){this.dialogFormVisible=!1},dialogSwitch:function(e){},dialogFormConfirm:function(e){var t=this,n=0;this.$refs[e].validate((function(e){for(var a=0;a<t.list.length;a++)t.formNumArr.push(t.list[a].num[0]||t.list[a].num);for(var r=0;r<t.formNumArr.length;r++)for(a=0;a<t.treeData.length;a++)t.formNumArr[r]==t.treeData[a].value&&(n++,t.treeData[a].label&&t.formNameArr.push(t.treeData[a].label),t.SerialNumber.push(n));for(var i=[],o=0;o<t.formNumArr.length;o++){var l={};l.professionnalTitleID=t.formNumArr[o],l.professionnalTitleName=t.formNameArr[o],l.sortNo=t.SerialNumber[o],i.push(l)}var u=t.formNumArr,c={processName:t.dialogForm.title,isEnable:t.dialogForm.state,nodes:i};"00"!=t.updatasId&&(c.id=t.updatasId);JSON.stringify(c);var d=m(u);if(1==d)return t.$message({message:"审批人选择重复！",type:"fail"}),!1;function m(e){return/(\x0f[^\x0f]+)\x0f[\s\S]*\1/.test(""+e.join("")+"")}e&&t.formNameArr.length==t.formNumArr.length?(t.dialogFormVisible=!1,0==t.addORupdata?Object(s["l"])(c).then((function(e){t.$message({message:"恭喜您，提交成功",type:"success"}),t.doRefresh()})):Object(s["j"])(c).then((function(e){t.$message({message:"恭喜您，提交成功",type:"success"}),t.doRefresh()}))):t.$message({message:"请检查填写信息不为空",type:"fail"})})),this.formNumArr=[],this.formNameArr=[],this.SerialNumber=[]},addForm:function(){var e={num:""};this.list.push(e)},delForm:function(){this.list.length>1?this.list=this.list.slice(0,-1):this.$message({message:"最后一个无法删除",type:"fail"})}}},d=c,m=(n("e720"),n("2877")),p=Object(m["a"])(d,a,r,!1,null,"8d48ec98",null);t["default"]=p.exports},e720:function(e,t,n){"use strict";var a=n("3a4a"),r=n.n(a);r.a}}]);