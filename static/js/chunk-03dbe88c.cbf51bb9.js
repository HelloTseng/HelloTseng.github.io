(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03dbe88c"],{1166:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar"}},[i("bar-space"),i("bar-cell",[i("el-button",{on:{click:e.goback}},[e._v("返回")])],1),e.isEdit?i("bar-cell",[i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")])],1):e._e()],1),i("div",{staticClass:"app-container"},[i("el-form",{ref:"elFormReply",staticClass:"text-gray",attrs:{model:e.elFormReply,rules:e.getVerificationScheme,size:e.tableSize,"label-position":"right","label-width":"120px"}},[i("el-row",[i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"站点名称",prop:"SiteName"}},[i("el-input",{attrs:{disabled:e.editDisabled},model:{value:e.elFormReply.SiteName,callback:function(t){e.$set(e.elFormReply,"SiteName",t)},expression:"elFormReply.SiteName"}})],1)],1),i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"类型",prop:"SiteType"}},[i("el-select",{attrs:{placeholder:"请选择",disabled:e.editDisabled},model:{value:e.elFormReply.SiteType,callback:function(t){e.$set(e.elFormReply,"SiteType",t)},expression:"elFormReply.SiteType"}},[i("el-option",{attrs:{label:"鉴定点",value:0}}),i("el-option",{attrs:{label:"鉴定站",value:1}})],1)],1)],1)],1),i("el-row",[i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"所属省市",prop:""}},[i("span",[e._v(e._s(e.elFormReply.ProvinceName))]),i("span",[e._v(e._s(e.elFormReply.CityName))]),i("span",[e._v(e._s(e.elFormReply.ReginName))])])],1),i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"通讯地址",prop:"Address"}},[i("el-input",{attrs:{disabled:e.editDisabled},model:{value:e.elFormReply.Address,callback:function(t){e.$set(e.elFormReply,"Address",t)},expression:"elFormReply.Address"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"联系人",prop:"UserName"}},[i("el-input",{attrs:{disabled:e.editDisabled},model:{value:e.elFormReply.UserName,callback:function(t){e.$set(e.elFormReply,"UserName",t)},expression:"elFormReply.UserName"}})],1)],1),i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"联系方式",prop:"MobilePhone"}},[i("el-input",{attrs:{disabled:e.editDisabled},model:{value:e.elFormReply.MobilePhone,callback:function(t){e.$set(e.elFormReply,"MobilePhone",t)},expression:"elFormReply.MobilePhone"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"职称",prop:"PTID"}},[i("span",[e._v(e._s(e.elFormReply.ProfessionnalTitle))])])],1),i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"身份证号",prop:"IDCardNum"}},[i("el-input",{attrs:{disabled:e.editDisabled},model:{value:e.elFormReply.IDCardNum,callback:function(t){e.$set(e.elFormReply,"IDCardNum",t)},expression:"elFormReply.IDCardNum"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{md:12}},[i("el-form-item",{attrs:{label:"系统角色",prop:"RoleID"}},[i("span",[e._v(e._s(e.elFormReply.RoleName))])])],1),i("el-col",{attrs:{md:12}})],1),i("el-divider"),i("el-form-item",{attrs:{label:"审核结果",prop:"AuditStatus"}},[i("el-radio-group",{attrs:{disabled:!e.isEdit},on:{change:e.changeAuditStatus},model:{value:e.elFormReply.AuditStatus,callback:function(t){e.$set(e.elFormReply,"AuditStatus",t)},expression:"elFormReply.AuditStatus"}},[i("el-radio",{attrs:{label:1}},[e._v("通过，同意建立")]),i("el-radio",{attrs:{label:2}},[e._v("驳回")])],1)],1),1===e.elFormReply.AuditStatus?i("el-form-item",{attrs:{label:"机构编码",prop:"OrganizationCode"}},[i("el-input",{attrs:{disabled:!e.isEdit,oninput:"if(value.length>7)value=value.slice(0,7)",placeholder:"请输入机构编码"},model:{value:e.elFormReply.OrganizationCode,callback:function(t){e.$set(e.elFormReply,"OrganizationCode",t)},expression:"elFormReply.OrganizationCode"}})],1):e._e(),i("el-form-item",{attrs:{label:"审核备注",prop:"AuditRemark"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入审核备注",autosize:{minRows:3},disabled:!e.isEdit},model:{value:e.elFormReply.AuditRemark,callback:function(t){e.$set(e.elFormReply,"AuditRemark",t)},expression:"elFormReply.AuditRemark"}})],1),1===e.elFormReply.AuditStatus?i("el-form-item",{staticStyle:{width:"600px"},attrs:{label:"检查报告",prop:"ReportFile"}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"element-loading-text":"附件上传中...",drag:"",limit:1,"file-list":e.fileList,"show-file-list":!0,loading:e.uploadLoading,action:e.UploadTempFileUrl,"before-upload":e.beforeUpload,"before-remove":e.beforeRemove,"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,disabled:!e.isEdit}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[i("em",[e._v("添加本地附件")])]),i("div",{staticClass:"el-upload__tip text-red",attrs:{slot:"tip"},slot:"tip"},[e._v("支持jpg/png/pdf，建议提交jpg")])])],1):e._e(),1===e.elFormReply.AuditStatus?i("el-form-item",{attrs:{label:"配置该机构可鉴定工种/等级",prop:"SiteProfessionLst"}},[i("table-body",{ref:"mkTable",attrs:{columns:e.columns,"table-data":e.elFormReply.SiteProfessionLst,options:e.tableOptions,"has-padding":!1}})],1):e._e(),i("el-form-item",[e.isEdit?i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")]):e._e()],1)],1)],1)],1)},r=[],o=(i("c975"),i("d3b7"),i("5530")),n=i("2f62"),l=i("bcb6"),s=(i("45fc"),i("60fe"));function u(e){var t=!1;return e.length>0&&(t=e.some((function(e){return e.IsToTheory||e.IsToSkills}))),t}var d={data:function(){return{isEdit:!1,editDisabled:!0,professionTitleOptions:[],roleOptions:[],fileList:[],uploadLoading:!1,UploadTempFileUrl:s["a"],elFormRefuseRules:{AuditRemark:[{required:!0,message:"请输入",trigger:"blur"}]},elFormPassRules:{AuditRemark:[{required:!0,message:"请输入",trigger:"blur"}],OrganizationCode:[{required:!0,message:"请输入",trigger:"blur"}],ReportFile:[{required:!0,message:"请上传",trigger:"blur"}],SiteProfessionLst:[{required:!0,trigger:"change",validator:function(e,t,i){var a=u(t);a?i():i(new Error("请选择可鉴定工种或技能"))}}]},columns:[{title:"职业工种",key:"ProfessionName",align:"center"},{title:"技能等级",key:"SkillLevelName",align:"center"},{title:"是否可鉴定理论",key:"IsToTheory",align:"center",component:{name:"el-switch"}},{title:"是否可鉴定技能",key:"IsToSkills",align:"center",component:{name:"el-switch"}}],tableOptions:{border:!0,headerCellClassName:"table-header-bg"},elFormReply:{SiteProfessionLst:[]}}}},p={name:"Detail",components:{BarCell:function(){return i.e("chunk-2d221e17").then(i.bind(null,"cbdf"))},BarSpace:function(){return i.e("chunk-2d2218de").then(i.bind(null,"cb9b"))},Sticky:function(){return i.e("chunk-2d210590").then(i.bind(null,"b804"))},TableBody:function(){return i.e("chunk-79d593e5").then(i.bind(null,"2c21"))}},mixins:[d],computed:Object(o["a"])(Object(o["a"])({},Object(n["c"])({tableSize:function(e){return e.settings.tableSize}})),{},{getVerificationScheme:function(){var e=null;return this.isEdit&&(e=1===this.elFormReply.AuditStatus?this.elFormPassRules:this.elFormRefuseRules),e}}),created:function(){this.$route.params&&this.doLoad()},methods:{doLoad:function(){var e=this,t=this.$route.params,i=t.id,a=t.isEdit;this.SiteAuditID=i,this.isEdit=a,Object(l["q"])({SiteAuditID:i}).then((function(t){t.success&&(0===t.response.AuditStatus&&(t.response.AuditStatus=1),e.elFormReply=t.response,e.loadFileList())})).then((function(){e.clearValidate()}))},goback:function(){this.$router.go(-1)},submitForm:function(){var e=this;this.$refs.elFormReply.validate((function(t){if(t){var i={},a=e.SiteAuditID,r=e.elFormReply,o=r.AuditStatus,n=r.AuditRemark,s=r.ReportFile,u=r.SiteProfessionLst;if(1===o){var d=e.elFormReply.OrganizationCode;i={SiteAuditID:a,AuditStatus:o,OrganizationCode:d,AuditRemark:n,ReportFile:s,SiteProfessionLst:u}}else 2===o&&(i={SiteAuditID:a,AuditStatus:o,AuditRemark:n,ReportFile:s});Object(l["p"])(i).then((function(t){t.success&&(e.$message({message:"恭喜您，提交成功",type:"success"}),e.goback())}))}else e.$message.error({message:"请检查填写是否完整"})}))},loadFileList:function(){var e=[],t=this.elFormReply.ReportFile;t&&(e.push({name:t,url:""}),this.fileList=e)},handleUploadSuccess:function(e,t){this.elFormReply.ReportFile=e.response.webupurl,this.uploadLoading=!1,this.$notify({title:"成功",message:"附件上传成功",type:"success"})},handleUploadError:function(){this.uploadLoading=!1,this.$message.error("附件上传失败，请稍后重试")},beforeRemove:function(){this.elFormReply.ReportFile=""},beforeUpload:function(e){this.uploadLoading=!0;var t=["image/jpeg","image/png","application/pdf"],i=t.indexOf(e.type)>-1,a=e.size/1024/1024<2;return i||(this.uploadLoading=!1,this.$message.error("附件格式有误")),a||(this.uploadLoading=!1,this.$message.error("附件大小不能超过 2MB")),i&&a},changeAuditStatus:function(){this.clearValidate()},clearValidate:function(){this.$refs["elFormReply"].clearValidate()}}},m=p,c=i("2877"),f=Object(c["a"])(m,a,r,!1,null,null,null);t["default"]=f.exports},"60fe":function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"e",(function(){return r})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return l})),i.d(t,"f",(function(){return s}));var a=["image/png","image/jpeg","image/jpg","image/gif"],r="image/png,image/jpeg,image/jpg,image/gif",o=["pdf","doc","docx","ppt","xls","xlsx"],n="".concat("http://172.16.3.14:8008/","images/Upload/TempPic"),l="".concat("http://172.16.3.14:8008/","images/Upload/TempFile"),s=[{txt:"图片",limitSize:800,type:["png","jpeg","jpg","gif"]},{txt:"文件",limitSize:2048,type:["pdf","doc","docx","ppt","pptx","xls","xlsx","wps"]},{txt:"视频",limitSize:51200,type:["mp4"]}]},bcb6:function(e,t,i){"use strict";i.d(t,"m",(function(){return r})),i.d(t,"k",(function(){return o})),i.d(t,"r",(function(){return n})),i.d(t,"u",(function(){return l})),i.d(t,"a",(function(){return s})),i.d(t,"h",(function(){return u})),i.d(t,"q",(function(){return d})),i.d(t,"p",(function(){return p})),i.d(t,"l",(function(){return m})),i.d(t,"s",(function(){return c})),i.d(t,"v",(function(){return f})),i.d(t,"g",(function(){return b})),i.d(t,"i",(function(){return g})),i.d(t,"t",(function(){return h})),i.d(t,"f",(function(){return R})),i.d(t,"e",(function(){return y})),i.d(t,"d",(function(){return S})),i.d(t,"j",(function(){return F})),i.d(t,"n",(function(){return v})),i.d(t,"w",(function(){return k})),i.d(t,"o",(function(){return A})),i.d(t,"c",(function(){return O})),i.d(t,"b",(function(){return j}));var a=i("b775");function r(e){return Object(a["a"])({url:"/vue-admin-template/station-management/review-detail",method:"get",params:e})}function o(e){return Object(a["a"])({url:"api/station/GetSiteAuditInfos",method:"get",params:e})}function n(e){return Object(a["a"])({url:"api/station/LoadSiteAuditInfo",method:"get",params:e})}function l(e){return Object(a["a"])({url:"api/station/SaveSiteAuditInfo",method:"post",data:e})}function s(e){return Object(a["a"])({url:"api/station/DelSiteAuditInfo",method:"get",params:e})}function u(e){return Object(a["a"])({url:"api/station/GetGuidanceSiteAuditInfos",method:"get",params:e})}function d(e){return Object(a["a"])({url:"api/station/LoadGuidanceSiteAuditInfo",method:"get",params:e})}function p(e){return Object(a["a"])({url:"api/station/GuidanceAuditSiteInfo",method:"post",data:e})}function m(e){return Object(a["a"])({url:"api/station/GetSiteInfos",method:"get",params:e})}function c(e){return Object(a["a"])({url:"api/station/LoadSiteInfo",method:"get",params:e})}function f(e){return Object(a["a"])({url:"api/station/SaveSiteInfo",method:"post",data:e})}function b(e){return Object(a["a"])({url:"api/station/ExamRoomList",method:"get",params:e})}function g(e){return Object(a["a"])({url:"api/station/LoadExamRoom",method:"get",params:e})}function h(e){return Object(a["a"])({url:"api/station/SaveExamRoom",method:"post",data:e})}function R(e){return Object(a["a"])({url:"api/station/EnableExamRooms",method:"get",params:e})}function y(e){return Object(a["a"])({url:"api/station/DisableExamRooms",method:"get",params:e})}function S(e){return Object(a["a"])({url:"api/station/DelExamRooms",method:"get",params:e})}function F(e){return Object(a["a"])({url:"api/Station/GetNotAuthTrainingInstitutions",method:"get",params:e})}function v(e){return Object(a["a"])({url:"api/Station/GetTrainingInstitutionInfo",method:"get",params:e})}function k(e){return Object(a["a"])({url:"api/Station/SubTrainingInstitutionAuth",method:"post",data:e})}function A(e){return Object(a["a"])({url:"api/Station/GetTrainingInstitutions",method:"get",params:e})}function O(e){return Object(a["a"])({url:"api/Station/EnableTrainingInstitution",method:"post",data:e})}function j(e){return Object(a["a"])({url:"api/Station/DisableTrainingInstitution",method:"post",data:e})}}}]);