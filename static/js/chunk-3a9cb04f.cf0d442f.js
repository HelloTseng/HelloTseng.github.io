(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a9cb04f"],{"1bb4":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-position":"right","label-width":"120px"}},[n("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar"}},[n("bar-space"),n("bar-cell",[n("el-button",{on:{click:e.goBack}},[e._v("返回")])],1),n("bar-cell",[n("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitForm}},[e._v("保存")])],1)],1),n("div",{staticClass:"app-container"},[n("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[n("el-input",{attrs:{maxlength:"30","show-word-limit":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title","string"===typeof t?t.trim():t)},expression:"form.title"}})],1),n("el-form-item",{attrs:{label:"是否置顶",prop:"isTop"}},[n("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.form.isTop,callback:function(t){e.$set(e.form,"isTop",t)},expression:"form.isTop"}})],1),n("el-form-item",{attrs:{label:"内容",prop:"content"}},[n("el-input",{staticStyle:{display:"none"},attrs:{type:"hidden"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}}),n("tinymce-editor",{ref:"tinymceEditor",model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),n("el-form-item",{attrs:{label:"附件",prop:"attachment"}},[n("upload",{attrs:{"file-list":e.form.attachment,"list-type":"text",drag:"",multiple:"",accept:".pdf, .doc, .docx, .ppt, .pptx, .xls, .xlsx, .wps","limit-size":e.limitSize,"get-file-list":e.getFileList}},[n("span",{attrs:{slot:"additional"},slot:"additional"},[e._v("建议提交pdf，")])])],1),n("el-form-item",[n("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submitForm}},[e._v("保存")])],1)],1)],1)},r=[],i=(n("99af"),n("4160"),n("caad"),n("b0c0"),n("a9e3"),n("b64b"),n("d3b7"),n("ac1f"),n("2532"),n("5319"),n("1276"),n("159b"),n("2909")),o=n("ade3"),u=n("5530"),c=(n("96cf"),n("1da1")),s=n("37cb"),l=n("0a4f"),d=n("60fe"),p={name:"Edit",components:{BarCell:function(){return n.e("chunk-2d221e17").then(n.bind(null,"cbdf"))},BarSpace:function(){return n.e("chunk-2d2218de").then(n.bind(null,"cb9b"))},Sticky:function(){return n.e("chunk-2d210590").then(n.bind(null,"b804"))},TinymceEditor:function(){return Promise.all([n.e("chunk-04e2eeec"),n.e("chunk-26882bc4")]).then(n.bind(null,"432e"))},Upload:function(){return n.e("chunk-6fe37a90").then(n.bind(null,"c7f0"))}},beforeRouteEnter:function(e,t,n){var a="";a=Number(e.params.id)?"编辑":"新增",n((function(e){e.$route.meta.title=a+"文章"}))},data:function(){return{loading:!1,KBId:0,routeName:"",isEdit:!1,kType:0,form:{title:"",isTop:0,attachment:[],removeFileList:[],content:""},formRules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],attachment:[{type:"array",required:!0,message:"请上传附件",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"change"}]},limitSize:d["f"][1].limitSize}},created:function(){var e=Number(this.$route.params.id);this.KBId=e,this.isEdit=0!==e,0!==e&&this.fetchData({KBId:e})},methods:{fetchData:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(s["x"])(e);case 2:a=n.sent,console.log("res",a),a.response.AnnexInfo.length&&a.response.AnnexInfo.forEach((function(e){var n={};Object.keys(e).forEach((function(t){n="Status"===t?Object(u["a"])(Object(u["a"])({},n),{},{sts:e[t]}):"AnnexName"===t?Object(u["a"])(Object(u["a"])({},n),{},{webupurl:e[t]}):"SourceName"===t?Object(u["a"])(Object(u["a"])({},n),{},{name:e[t]}):Object(u["a"])(Object(u["a"])({},n),{},Object(o["a"])({},t,e[t]))})),n=Object(u["a"])(Object(u["a"])({},n),{},{fileName:e.AnnexName.split("/")[e.AnnexName.split("/").length-1],url:Object(l["a"])().ResourcesURL+e.AnnexName}),t.form.attachment.push(n)})),t.form=Object(u["a"])(Object(u["a"])({},t.form),{},{title:a.response.Title,isTop:a.response.IsTop?1:0,content:a.response.Content});case 6:case"end":return n.stop()}}),n)})))()},goBack:function(){this.$router.replace({name:"DataLibraryIndex"})},submitForm:function(){var e=this;this.$refs.form.validate(function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(n){var a,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=20;break}if(!e.loading){t.next=3;break}return t.abrupt("return");case 3:if(e.loading=!0,a=[],e.form.attachment.forEach((function(e){var t=0,n=0;Object.keys(e).includes("AI_ID")&&(t=e.AI_ID),Object.keys(e).includes("sts")&&(n=e.sts),a.push({AI_ID:t,AnnexName:e.webupurl,AnnexType:e.type,sourceName:e.name,Status:n})})),a=[].concat(Object(i["a"])(a),Object(i["a"])(e.form.removeFileList)),r={KID:e.KBId,kType:e.kType,title:e.form.title,isTop:e.form.isTop,content:e.form.content,annexInfo:a},e.isEdit){t.next=14;break}return t.next=11,Object(s["c"])(r);case 11:o=t.sent,t.next=17;break;case 14:return t.next=16,Object(s["M"])(r);case 16:o=t.sent;case 17:e.loading=!1,console.log("res",o),o.success&&(e.$notify({title:"成功",message:o.msg,type:"success"}),e.goBack());case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getFileList:function(e,t,n,a){console.log("----------------------------------------------"),console.log("getFileList",e,t,n,a),"remove"===e&&Object.keys(t).includes("AI_ID")&&this.form.removeFileList.push({AI_ID:t.AI_ID,Status:1,AnnexName:t.webupurl,AnnexType:t.AnnexType,sourceName:t.name}),this.againValidate("attachment")},againValidate:function(e){this.$refs.form.validateField(e)}}},f=p,m=n("2877"),b=Object(m["a"])(f,a,r,!1,null,null,null);t["default"]=b.exports},"37cb":function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"y",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"n",(function(){return u})),n.d(t,"j",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"M",(function(){return l})),n.d(t,"x",(function(){return d})),n.d(t,"A",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"I",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"E",(function(){return g})),n.d(t,"G",(function(){return h})),n.d(t,"C",(function(){return j})),n.d(t,"p",(function(){return O})),n.d(t,"u",(function(){return x})),n.d(t,"F",(function(){return M})),n.d(t,"B",(function(){return v})),n.d(t,"l",(function(){return k})),n.d(t,"t",(function(){return W})),n.d(t,"a",(function(){return y})),n.d(t,"K",(function(){return I})),n.d(t,"z",(function(){return w})),n.d(t,"d",(function(){return A})),n.d(t,"s",(function(){return S})),n.d(t,"o",(function(){return D})),n.d(t,"N",(function(){return L})),n.d(t,"k",(function(){return B})),n.d(t,"D",(function(){return E})),n.d(t,"f",(function(){return F})),n.d(t,"O",(function(){return T})),n.d(t,"w",(function(){return N})),n.d(t,"b",(function(){return U})),n.d(t,"L",(function(){return C})),n.d(t,"q",(function(){return K})),n.d(t,"m",(function(){return G})),n.d(t,"h",(function(){return _})),n.d(t,"v",(function(){return $})),n.d(t,"H",(function(){return z})),n.d(t,"J",(function(){return R}));var a=n("b775");function r(e){return Object(a["a"])({url:"api/WebManager/DeleteInfo",method:"post",data:e})}function i(e){return Object(a["a"])({url:"api/WebManager/GetKnowledgeBaseList",method:"get",params:e})}function o(e){return Object(a["a"])({url:"api/WebManager/EnableKnowledgeBase",method:"post",data:e})}function u(e){return Object(a["a"])({url:"api/WebManager/DisableKnowledgeBase",method:"post",data:e})}function c(e){return Object(a["a"])({url:"api/WebManager/DeleteKnowledgeBase",method:"post",data:e})}function s(e){return Object(a["a"])({url:"api/WebManager/AddKnowledgeBase",method:"post",data:e})}function l(e){return Object(a["a"])({url:"api/WebManager/UpdateKnowledgeBase",method:"post",data:e})}function d(e){return Object(a["a"])({url:"api/WebManager/GetKnowledgeBase",method:"get",params:e})}function p(e){return Object(a["a"])({url:"api/WebManager/GetManuscriptList",method:"get",params:e})}function f(e){return Object(a["a"])({url:"api/WebManager/ApprovedManuscript",method:"post",useJSON:!0,data:e})}function m(e){return Object(a["a"])({url:"api/WebManager/ManuscriptDelivery",method:"post",data:e})}function b(e){return Object(a["a"])({url:"api/WebManager/AddManuscriptInfo",method:"post",data:e})}function g(e){return Object(a["a"])({url:"api/WebManager/GetSupervisorList",method:"get",params:e})}function h(e){return Object(a["a"])({url:"api/WebManager/UpdateSupervis",method:"get",params:e})}function j(e){return Object(a["a"])({url:"api/WebManager/OrderBySupervis",method:"get",params:e})}function O(e){return Object(a["a"])({url:"api/WebManager/DisableSupervisPublic",method:"post",data:e})}function x(e){return Object(a["a"])({url:"api/WebManager/GetExaminerInfoList",method:"get",params:e})}function M(e){return Object(a["a"])({url:"api/WebManager/UpdateExaminerInfo",method:"get",params:e})}function v(e){return Object(a["a"])({url:"api/WebManager/OrderByExaminerInfo",method:"get",params:e})}function k(e){return Object(a["a"])({url:"api/WebManager/DisableExaminerInfoPublic",method:"post",data:e})}function W(e){return Object(a["a"])({url:"api/WebManager/GetContactUs",method:"get",params:e})}function y(e){return Object(a["a"])({url:"api/WebManager/AddContactUs",method:"post",data:e})}function I(e){return Object(a["a"])({url:"api/WebManager/UpdateContactUs",method:"post",data:e})}function w(e){return Object(a["a"])({url:"api/WebManager/GetLinkList",method:"get",params:e})}function A(e){return Object(a["a"])({url:"api/WebManager/AddLink",method:"post",data:e})}function S(e){return Object(a["a"])({url:"api/WebManager/EnableLink",method:"post",data:e})}function D(e){return Object(a["a"])({url:"api/WebManager/DisableLink",method:"post",data:e})}function L(e){return Object(a["a"])({url:"api/WebManager/UpdateLink",method:"post",data:e})}function B(e){return Object(a["a"])({url:"api/WebManager/DeleteLink",method:"post",data:e})}function E(e){return Object(a["a"])({url:"api/WebManager/GetSiteInfo",method:"get",params:e})}function F(e){return Object(a["a"])({url:"api/WebManager/AddSiteInfo",method:"post",data:e})}function T(e){return Object(a["a"])({url:"api/WebManager/UpdateSiteInfo",method:"post",data:e})}function N(e){return Object(a["a"])({url:"api/WebManager/GetFloatChartList",method:"get",params:e})}function U(e){return Object(a["a"])({url:"api/WebManager/AddFloatChart",method:"post",data:e})}function C(e){return Object(a["a"])({url:"api/WebManager/UpdateFloatChart",method:"post",data:e})}function K(e){return Object(a["a"])({url:"api/WebManager/EnableFloatChart",method:"post",data:e})}function G(e){return Object(a["a"])({url:"api/WebManager/DisableFloatChart",method:"post",data:e})}function _(e){return Object(a["a"])({url:"api/WebManager/DeleteFloatChart",method:"post",data:e})}function $(e){return Object(a["a"])({url:"api/WebManager/GetFloatChart",method:"get",params:e})}function z(e){return Object(a["a"])({url:"api/WebManager/GetUserAgreement",method:"get",params:e})}function R(e){return Object(a["a"])({url:"api/WebManager/SetUserAgreement",method:"post",useJSON:!0,data:e})}},"60fe":function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return c}));var a=["image/png","image/jpeg","image/jpg","image/gif"],r="image/png,image/jpeg,image/jpg,image/gif",i=["pdf","doc","docx","ppt","xls","xlsx"],o="".concat("http://172.16.3.14:8008/","images/Upload/TempPic"),u="".concat("http://172.16.3.14:8008/","images/Upload/TempFile"),c=[{txt:"图片",limitSize:800,type:["png","jpeg","jpg","gif"]},{txt:"文件",limitSize:2048,type:["pdf","doc","docx","ppt","pptx","xls","xlsx","wps"]},{txt:"视频",limitSize:51200,type:["mp4"]}]}}]);