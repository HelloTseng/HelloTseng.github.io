(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c73974c"],{2934:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return s})),n.d(t,"k",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return h})),n.d(t,"d",(function(){return g}));var r=n("b775");function a(e){return Object(r["a"])({url:"api/Sys/CheckUserInfo",method:"get",noNoticeError:!0,params:e})}function i(e){return Object(r["a"])({url:"api/Sys/GetSelRoleList",method:"get",params:e})}function o(e){return Object(r["a"])({url:"api/Sys/GetEnableProfessionnalTitles",method:"get",params:e})}function l(e){return Object(r["a"])({url:"api/Sys/GetEnableExaminerProfessionnalTitles",method:"get",params:e})}function s(e){return Object(r["a"])({url:"api/Global/GetRegionList",method:"get",params:e})}function u(e){return Object(r["a"])({url:"api/Station/GetSelSites",method:"get",params:e})}function c(e){return Object(r["a"])({url:"api/Sys/EnableProfessionList",method:"get",params:e})}function d(e){return Object(r["a"])({url:"api/Examination/LoadQuestionBankOptions",method:"get",params:e})}function m(e){return Object(r["a"])({url:"api/Sys/GetEnableEQLanguages",method:"get",params:e})}function f(e){return Object(r["a"])({url:"api/Station/EnableExamRoomLst",method:"get",params:e})}function p(e){return Object(r["a"])({url:"images/Upload/TempPic",method:"post",data:e,multiple:!0})}function b(e){return Object(r["a"])({url:"images/Upload/TempFile",method:"post",data:e,multiple:!0})}function h(e){return Object(r["a"])({url:"api/images/Upload/NewPic",method:"post",data:e,multiple:!0})}function g(e){return Object(r["a"])({url:"api/Station/EnableExaminerInfos",method:"get",params:e})}},"39f0":function(e,t,n){"use strict";n.d(t,"o",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"r",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"i",(function(){return u})),n.d(t,"q",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"s",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"f",(function(){return h})),n.d(t,"n",(function(){return g})),n.d(t,"m",(function(){return v})),n.d(t,"a",(function(){return k})),n.d(t,"v",(function(){return C})),n.d(t,"p",(function(){return y})),n.d(t,"d",(function(){return D})),n.d(t,"c",(function(){return O})),n.d(t,"u",(function(){return w})),n.d(t,"t",(function(){return x}));var r=n("b775");function a(e){return Object(r["a"])({url:"api/Examination/QuestionBanks",method:"get",params:e})}function i(e){return Object(r["a"])({url:"api/Examination/EnableQuestionBank",method:"get",params:e})}function o(e){return Object(r["a"])({url:"api/Examination/DisableQuestionBank",method:"get",params:e})}function l(e){return Object(r["a"])({url:"api/Examination/SaveQuestionBank",method:"post",data:e})}function s(e){return Object(r["a"])({url:"api/Examination/AddQuestionBank",method:"post",data:e})}function u(e){return Object(r["a"])({url:"api/Examination/LoadQuestionSearchOptions",method:"get",params:e})}function c(e){return Object(r["a"])({url:"api/Examination/TheoryQuestions",method:"get",params:e})}function d(e){return Object(r["a"])({url:"api/Examination/LoadQuestionsModel",method:"get",params:e})}function m(e){return Object(r["a"])({url:"api/Examination/LoadQuestionsClass",method:"get",params:e})}function f(e){return Object(r["a"])({url:"api/Examination/LoadQuestionsBook",method:"get",params:e})}function p(e){return Object(r["a"])({url:"api/Examination/SaveQuestions",method:"post",data:e})}function b(e){return Object(r["a"])({url:"api/Examination/EnableQuestions",method:"get",params:e})}function h(e){return Object(r["a"])({url:"api/Examination/DisableQuestions",method:"get",params:e})}function g(e){return Object(r["a"])({url:"api/Examination/GetPaperRulesList",method:"get",params:e})}function v(e){return Object(r["a"])({url:"api/Examination/GetPaperRules",method:"get",params:e})}function k(e){return Object(r["a"])({url:"api/Examination/AddPaperRules",method:"post",data:e})}function C(e){return Object(r["a"])({url:"api/Examination/UpdatePaperRules",method:"post",data:e})}function y(e){return Object(r["a"])({url:"api/Examination/TheoryQuestionBanks",method:"get",params:e})}function D(e){return Object(r["a"])({url:"api/Examination/EnablePaperRules",method:"post",data:e})}function O(e){return Object(r["a"])({url:"api/Examination/DisablePaperRules",method:"post",data:e})}function w(e){return Object(r["a"])({url:"api/Examination/TheoryQuestionBanksClass",method:"post",data:e})}function x(e){return Object(r["a"])({url:"api/Examination/TheoryQuestionBanksBook",method:"post",data:e})}},c35e:function(e,t,n){},cf45:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return d}));n("4160"),n("baa5"),n("b680"),n("ac1f"),n("5319"),n("159b");function r(e,t){return e.forEach((function(e){e[t]&&e[t].length?r(e[t],t):e[t]=null})),e}function a(e){var t="";try{var n=new Date(e.replace(/-/g,"/")),r=new Date,a=r.getMonth()<n.getMonth()||r.getMonth()===n.getMonth()&&r.getDate()<n.getDate();t=r.getFullYear()-n.getFullYear()-(a?1:0)}catch(i){console.warn("--\x3e Error getYearsByDate",i)}return t}function i(e){var t,n=e.substring(e.lastIndexOf(".")+1);switch(n){case"pdf":t=0;break;case"doc":t=1;break;case"docx":t=2;break;case"wps":t=3;break;case"ppt":t=4;break;case"xls":t=5;break;case"xlsx":t=6;break;case"mp4":t=7;break;case"pptx":t=8;break;default:t=-1}return t}var o=[{value:0,label:"党员"},{value:1,label:"群众"},{value:2,label:"其他"}],l=[{value:9,label:"博士研究生"},{value:8,label:"硕士研究生"},{value:7,label:"本科"},{value:6,label:"专科"},{value:5,label:"中技"},{value:4,label:"职校"},{value:3,label:"中专"},{value:2,label:"高中"},{value:1,label:"初中"},{value:0,label:"小学"}],s=[{value:11,label:"博士研究生"},{value:10,label:"硕士研究生"},{value:9,label:"本科"},{value:8,label:"专科"},{value:7,label:"高技"},{value:6,label:"中技"},{value:5,label:"高职"},{value:4,label:"中职"},{value:3,label:"中专"},{value:2,label:"高中"},{value:1,label:"初中"},{value:0,label:"小学"}],u=[{value:2,label:"保密"},{value:1,label:"男"},{value:0,label:"女"}],c=[{value:3,label:"其他证件"},{value:2,label:"护照"},{value:1,label:"港澳台证"},{value:0,label:"身份证"}];function d(e){var t=e;return t=e>1048576?(e/1048576).toFixed(2)+"GB":e>1024?(e/1024).toFixed(2)+"MB":"".concat(e,"KB"),t}},df21:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-position":"right","label-width":"120px"}},[n("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar"}},[n("bar-space"),n("bar-cell",[n("el-button",{on:{click:e.goback}},[e._v("返回")])],1),n("bar-cell",[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v(e._s(e.isEdit?"保存":"确认添加"))])],1)],1),n("div",{staticClass:"app-container"},[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"鉴定工种",prop:"wordCID"}},[e.isEdit?n("span",[e._v(e._s(e.form.wordCName))]):n("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(t){return e.handleChange(t,"wordCID")}},model:{value:e.form.wordCID,callback:function(t){e.$set(e.form,"wordCID",t)},expression:"form.wordCID"}},e._l(e.professionOptions,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})})),1)],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"鉴定等级",prop:"gradeCID"}},[e.isEdit?n("span",[e._v(e._s(e.form.gradeCName))]):n("el-select",{attrs:{filterable:"",placeholder:e.skillOptions.length?"请选择":"请先选择职业工种",disabled:!e.skillOptions.length},on:{change:function(t){return e.handleChange(t,"gradeCID")}},model:{value:e.form.gradeCID,callback:function(t){e.$set(e.form,"gradeCID",t)},expression:"form.gradeCID"}},e._l(e.skillOptions,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})})),1)],1)],1),n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"鉴定方向",prop:"directionID"}},[e.isEdit?n("span",[e._v(e._s(e.form.directionName))]):n("el-select",{attrs:{filterable:"",placeholder:e.directionOptions.length?"请选择":"请先选择技能等级",disabled:!e.directionOptions.length},on:{change:function(t){return e.handleChange(t,"directionID")}},model:{value:e.form.directionID,callback:function(t){e.$set(e.form,"directionID",t)},expression:"form.directionID"}},e._l(e.directionOptions,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})})),1)],1)],1)],1),n("el-form-item",{attrs:{label:"规则名称",prop:"prName"}},[n("el-input",{model:{value:e.form.prName,callback:function(t){e.$set(e.form,"prName",t)},expression:"form.prName"}})],1),n("el-divider"),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"考试总分"}},[n("strong",{staticClass:"text-red"},[e._v(e._s(e.examScore))]),n("span",[e._v(" （系统根据试题配置自动合计分数）")])])],1),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"及格分数",prop:"passingGrade"}},[n("el-input",{staticStyle:{width:"100px"},model:{value:e.form.passingGrade,callback:function(t){e.$set(e.form,"passingGrade",t)},expression:"form.passingGrade"}})],1)],1)],1),n("el-form-item",{attrs:{label:"试题配置",prop:"config"}},[n("table-body",{staticClass:"formTable",attrs:{"has-padding":!1,columns:e.configColumns,"table-data":e.form.config,options:e.tableOptions}},[n("el-table-column",{attrs:{slot:"singleCount",label:"单选题数量","min-width":"150"},slot:"singleCount",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-input",{model:{value:r.singleCount,callback:function(t){e.$set(r,"singleCount",e._n(t))},expression:"row.singleCount"}},[n("template",{slot:"append"},[e._v("条")])],2)]}}])}),n("el-table-column",{attrs:{slot:"multipleCount",label:"多选题数量","min-width":"150"},slot:"multipleCount",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-input",{model:{value:r.multipleCount,callback:function(t){e.$set(r,"multipleCount",e._n(t))},expression:"row.multipleCount"}},[n("template",{slot:"append"},[e._v("条")])],2)]}}])}),n("el-table-column",{attrs:{slot:"judgeCount",label:"判断题数量","min-width":"150"},slot:"judgeCount",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-input",{model:{value:r.judgeCount,callback:function(t){e.$set(r,"judgeCount",e._n(t))},expression:"row.judgeCount"}},[n("template",{slot:"append"},[e._v("条")])],2)]}}])}),n("el-table-column",{attrs:{slot:"allotment",label:"单条配分","min-width":"150"},slot:"allotment",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-input",{on:{input:e.checkScore},model:{value:r.allotment,callback:function(t){e.$set(r,"allotment",t)},expression:"row.allotment"}},[n("template",{slot:"prepend"},[e._v("每题")]),n("template",{slot:"append"},[e._v("分")])],2)]}}])})],1)],1),n("el-divider"),n("el-form-item",{attrs:{label:"应用题库",prop:"library"}},[n("el-button",{attrs:{type:"primary",plain:""},on:{click:e.openLibrary}},[e._v("选择题库")]),e._l(e.form.library,(function(t,r){return n("div",{key:r},[n("div",{attrs:{flex:""}},[n("strong",{staticStyle:{"font-size":"16px","margin-right":"10px"}},[e._v(e._s(t.QBName))]),n("el-link",{attrs:{type:"danger"},on:{click:function(n){return e.deleteSelectLibrary(r,t.QBID)}}},[e._v("删除")])],1)])}))],2),n("el-form-item",{attrs:{label:"试题组成"}},[n("el-radio-group",{model:{value:e.form.make,callback:function(t){e.$set(e.form,"make",t)},expression:"form.make"}},[n("el-radio",{attrs:{label:0}},[e._v("按试题分类")]),n("el-radio",{attrs:{label:1}},[e._v("按试题章节")])],1)],1),n("el-form-item",{attrs:{prop:"makeList"}},[n("table-body",{staticClass:"formTable",attrs:{"has-padding":!1,columns:e.makeupColumns,"table-data":e.form.makeList[e.form.make],options:e.tableOptions}},[n("el-table-column",{attrs:{slot:"text",label:0===e.form.make?"选择试题分类":"选择题库章节","header-align":"center","min-width":"300"},slot:"text",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("span",[e._v(e._s(r.text))])]}}])}),n("el-table-column",{attrs:{slot:"QuestionsCount",label:"试题数量",align:"center","min-width":"150"},slot:"QuestionsCount",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("el-input",{on:{input:function(t){return e.checkCount(t,r)}},model:{value:r.QuestionsCount,callback:function(t){e.$set(r,"QuestionsCount",e._n(t))},expression:"row.QuestionsCount"}},[n("template",{slot:"append"},[e._v("条")])],2)]}}])}),n("el-table-column",{attrs:{slot:"ratio",label:"试题占比",align:"center","min-width":"150"},slot:"ratio",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("input-percent",{attrs:{value:r.ratio,width:"100%"},on:{"update:value":function(t){return e.$set(r,"ratio",t)},input:function(t){return e.checkRatio(t,r)}}})]}}])}),n("el-table-column",{attrs:{slot:"operate",label:"操作",width:"100",align:"center"},slot:"operate",scopedSlots:e._u([{key:"header",fn:function(t){var r=t.row;return[n("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return e.handleOpen(r)}}},[e._v("新增")])]}},{key:"default",fn:function(t){var r=t.$index,a=t.row;return[n("popconfirm-link",{attrs:{title:"确定要删除该试题吗？"},on:{"do-confirm":function(t){return e.handleDelete(r,a)}}})]}}])})],1)],1),n("el-form-item",{attrs:{label:"考试难度占比",prop:"difficulty"}},[n("table-body",{staticClass:"formTable",attrs:{"has-padding":!1,columns:e.scaleColumns,"table-data":e.form.difficulty,options:e.tableOptions}},[n("el-table-column",{attrs:{slot:"easy",label:"容易","header-align":"center","min-width":"150"},slot:"easy",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("input-percent",{attrs:{value:r.easy,width:"100%"},on:{"update:value":function(t){return e.$set(r,"easy",t)}}})]}}])}),n("el-table-column",{attrs:{slot:"medium",label:"中等","header-align":"center","min-width":"150"},slot:"medium",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("input-percent",{attrs:{value:r.medium,width:"100%"},on:{"update:value":function(t){return e.$set(r,"medium",t)}}})]}}])}),n("el-table-column",{attrs:{slot:"hard",label:"困难","header-align":"center","min-width":"150"},slot:"hard",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[n("input-percent",{attrs:{value:r.hard,width:"100%"},on:{"update:value":function(t){return e.$set(r,"hard",t)}}})]}}])})],1)],1)],1)],1),n("el-dialog",{attrs:{title:"选择题库",visible:e.libraryVisible,"destroy-on-close":"","before-close":function(){e.libraryVisible=!1}}},[n("table-body",{ref:"mkTable",attrs:{loading:e.tableLoading,"has-padding":!1,columns:e.columns,"selection-row":e.selectionRow,"table-data":e.libraryList,options:e.tableOptions},on:{"selection-change":e.handleSelectionChange}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.clearSelection}},[e._v("清空选择")]),n("el-button",{attrs:{type:"primary"},on:{click:e.confirmSelection}},[e._v("确 定")])],1)],1),n("el-dialog",{attrs:{title:"选择试题分类",visible:e.classVisible,"destroy-on-close":"","before-close":e.closeDialog}},[n("el-form",{ref:"selectForm",attrs:{model:e.selectForm,"label-position":"right","label-width":"120px"}},[n("el-form-item",{attrs:{label:"试题分类",rules:[{type:"array",required:!0,message:"请选择",trigger:"change"}],prop:"selectValue"}},[e.cascaderOptions.length?n("el-cascader",{ref:"classCascader",staticClass:"width-full",attrs:{options:e.cascaderOptions,props:{value:"TreeID",label:"TreeName",children:"SubTree"},filterable:""},model:{value:e.selectForm.selectValue,callback:function(t){e.$set(e.selectForm,"selectValue",t)},expression:"selectForm.selectValue"}}):e._e()],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSelect("classCascader")}}},[e._v("确认选择")])],1)],1),n("el-dialog",{attrs:{title:"选择试题章节",visible:e.bookVisible,"destroy-on-close":"","before-close":e.closeDialog}},[n("el-form",{ref:"selectForm",attrs:{model:e.selectForm,"label-position":"right","label-width":"120px"}},[n("el-form-item",{attrs:{label:"试题题库",rules:[{required:!0,message:"请选择",trigger:"change"}],prop:"selectLibrary"}},[n("el-select",{staticClass:"width-full",staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请选择题库"},model:{value:e.selectForm.selectLibrary,callback:function(t){e.$set(e.selectForm,"selectLibrary",t)},expression:"selectForm.selectLibrary"}},e._l(e.libraryList,(function(e){return n("el-option",{key:e.QBID,attrs:{label:e.QBName,value:e.QBID}})})),1)],1),n("el-form-item",{attrs:{label:"试题章节",rules:[{type:"array",required:!0,message:"请选择",trigger:"change"}],prop:"selectValue"}},[e.cascaderOptions.length?n("el-cascader",{key:e.selectForm.selectLibrary,ref:"bookCascader",staticClass:"width-full",attrs:{options:e.cascaderOptions,props:{value:"TreeID",label:"TreeName",children:"SubTree"},placeholder:"请选择",filterable:"",disabled:!e.cascaderOptions.length},model:{value:e.selectForm.selectValue,callback:function(t){e.$set(e.selectForm,"selectValue",t)},expression:"selectForm.selectValue"}}):n("span",[e._v("请先选择题库")])],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSelect("bookCascader")}}},[e._v("确认选择")])],1)],1)],1)},a=[],i=(n("99af"),n("4de4"),n("7db0"),n("c740"),n("4160"),n("c975"),n("a15b"),n("d81d"),n("13d5"),n("fb6a"),n("a434"),n("a9e3"),n("d3b7"),n("ac1f"),n("5319"),n("1276"),n("159b"),n("5530")),o=n("2909"),l=(n("96cf"),n("1da1")),s=n("cf45"),u=n("2934"),c=n("39f0"),d=n("ed08"),m={name:"TheoryPaperDetail",components:{BarCell:function(){return n.e("chunk-2d221e17").then(n.bind(null,"cbdf"))},BarSpace:function(){return n.e("chunk-2d2218de").then(n.bind(null,"cb9b"))},Sticky:function(){return n.e("chunk-2d210590").then(n.bind(null,"b804"))},TableBody:function(){return n.e("chunk-79d593e5").then(n.bind(null,"2c21"))},InputPercent:function(){return n.e("chunk-2d0abfe2").then(n.bind(null,"1849"))},PopconfirmLink:function(){return n.e("chunk-f9b7a5e6").then(n.bind(null,"1417"))}},props:{isEdit:{type:Boolean,default:!1}},data:function(){var e=this,t=function(e,t,n){var r=t[0],a=r.allotment,i=r.judgeCount,o=r.multipleCount,l=r.singleCount,s=""!==a&&""!==i&&""!==o&&""!==l;return s?n():n(new Error("请检查试题配置漏填的"))},n=function(e,t,n){var r=t[0],a=r.easy,i=r.medium,o=r.hard,l=Number(a)+Number(i)+Number(o);return l>100?n(new Error("考试难度占比合计不能超过100%")):100!==l?n(new Error("考试难度各难度占比和需等于100%")):n()},r=function(t,n,r){var a=e.form.make,i=a?'请给"试题组成-试题章节"新增试题':'请给"试题组成-试题分类新增"试题';if(n[a].length<1)return r(new Error("".concat(i)));var o=n[a].map((function(e){return Number(e.QuestionsCount)})).reduce((function(e,t){return e+t}));if(o<e.total)return r(new Error("试题数量合计不得小于试题配置数量".concat(e.total)));var l=n[a].map((function(e){return Number(e.ratio)})).reduce((function(e,t){return e+t}));return l>100?r(new Error("试题占比合计不得大于100%")):r()};return{prid:0,professionOptions:[],skillOptions:[],directionOptions:[],form:{wordCID:"",wordCName:"",gradeCID:"",gradeCName:"",directionID:"",directionName:"",prName:"",passingGrade:0,library:[],config:[{singleCount:0,multipleCount:0,judgeCount:0,allotment:.5}],difficulty:[],make:0,makeList:[[],[]]},rules:{wordCID:[{required:!0,message:"请选择",trigger:"change"}],gradeCID:[{required:!0,message:"请选择",trigger:"change"}],directionID:[{required:!0,message:"请选择",trigger:"change"}],prName:[{required:!0,message:"请输入",trigger:"blur"}],passingGrade:[{required:!0,message:"请输入",trigger:"blur"}],config:[{required:!0,validator:t}],difficulty:[{required:!0,validator:n,trigger:"blur"}],makeList:[{required:!0,validator:r}]},libraryList:[],defaultLibraryList:[],libraryVisible:!1,tableLoading:!1,selectionRow:{align:"center"},tableOptions:{border:!0,headerCellClassName:"table-header-bg"},columns:[{title:"题库名称",key:"QBName",headerAlign:"center","min-width":"300px"},{title:"试题数量",key:"QuestionCount",align:"center",minWidth:70},{title:"更新时间",key:"LastUpdateDate",align:"center",minWidth:140,formatter:function(e,t,n,r){return Object(d["e"])(e.LastUpdateDate,"{y}-{m}-{d} {h}:{i}")}}],configColumns:[{key:"singleCount",slot:"singleCount"},{key:"multipleCount",slot:"multipleCount"},{key:"judgeCount",slot:"judgeCount"},{key:"allotment",slot:"allotment"}],scaleColumns:[{key:"easy",slot:"easy"},{key:"medium",slot:"medium"},{key:"hard",slot:"hard"}],makeupColumns:[{key:"text",slot:"text"},{title:"所属题库",key:"qbName",align:"center",minWidth:"200px"},{title:"可用试题数量",key:"Questions",align:"center",minWidth:"100"},{key:"QuestionsCount",slot:"QuestionsCount"},{key:"ratio",slot:"ratio"}],cascaderOptions:[],options:[],saveOptions:[],classVisible:!1,bookVisible:!1,selectForm:{selectLibrary:"",selectValue:[]},removeList:[],editType:null,tmpSelection:[]}},computed:{examScore:function(){var e=this.form.config[0],t=e.singleCount,n=e.multipleCount,r=e.judgeCount,a=e.allotment;return(t+n+r)*a},total:function(){var e=this.form.config[0],t=e.singleCount,n=e.multipleCount,r=e.judgeCount;return t+n+r}},watch:{"selectForm.selectLibrary":{handler:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return t.cascaderOptions=[],r=[e],n.next=6,Object(c["t"])({QBIDs:r});case 6:a=n.sent,a.success&&(t.cascaderOptions=Object(s["g"])(a.response.TreeList,"SubTree"),t.saveOptions=a.response.ClassCount,t.selectForm.selectValue=[]);case 8:case"end":return n.stop()}}),n)})))()}},"form.directionID":{handler:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r,a,i,o,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:return r=t.form,a=r.wordCID,i=r.gradeCID,o={ProfessionID:a,SkillID:i,DirectionID:e},n.next=6,Object(c["p"])(o);case 6:l=n.sent,l.success&&(t.libraryList=l.response,t.defaultLibraryList=l.response);case 8:case"end":return n.stop()}}),n)})))()},immediate:!0}},created:function(){if(this.isEdit){var e=this.$route.params&&this.$route.params.id;this.prid=Number(e),this.fetchDetail({PRId:Number(e)})}else this.fetchData(),this.form.difficulty[0]={easy:"0.00",medium:"0.00",hard:"0.00"}},methods:{fetchDetail:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["m"])(e);case 2:r=n.sent,r.success&&(r=r.response,t.form={wordCID:r.WordCID,wordCName:r.WordCName,gradeCID:r.GradeCID,gradeCName:r.GradeCName,directionID:r.DirectionID,directionName:r.DirectionName,prName:r.PRName,passingGrade:r.PassingGrade,library:r.BankList,config:[{singleCount:r.SingleCount,multipleCount:r.MultipleCount,judgeCount:r.JudgeCount,allotment:r.Allotment}],difficulty:[{easy:r.EasyRatio,medium:r.MediumRatio,hard:r.DifficultRatio}],make:r.CombinationType,makeList:[[],[]]},t.editType=r.CombinationType,t.form.makeList[r.CombinationType]=r.DetailList.map((function(e){return{prrid:e.PRRID,prid:e.PRID,qbid:e.QBID,qcid:e.QCID,ratio:e.Ratio,Questions:e.Questions,QuestionsCount:e.QuestionsCount,text:e.QCName,qbName:e.QBName,Status:e.Status}})));case 4:case"end":return n.stop()}}),n)})))()},fetchData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["h"])();case 2:n=t.sent,n.success&&(e.professionOptions=n.response);case 4:case"end":return t.stop()}}),t)})))()},goback:function(){this.$router.replace({name:"TheoryPaperIndex"})},submitForm:function(){var e=this;this.$refs.form.validate(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(n){var r,a,i,l,s,u,d,m,f,p,b,h,g,v,k,C,y,D,O,w,x;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=20;break}if(r=e.form,a=r.wordCID,i=r.gradeCID,l=r.directionID,s=r.prName,u=r.passingGrade,d=r.config,m=r.difficulty,f=r.make,p=r.makeList,b=e.removeList,h=e.isEdit,g=e.editType,v=function(e,t){return e.map((function(e){var n=t||e.Status;return{prrid:e.prrid,prid:e.prid,qbid:e.qbid,qcid:e.qcid,ratio:e.ratio,questionsCount:e.QuestionsCount,Status:n}}))},k=v(p[f]),C=v(b,1),y=[],h&&g!==f&&(y=v(p[g],1)),D=[].concat(Object(o["a"])(k),Object(o["a"])(C),Object(o["a"])(y)),O={prid:e.prid,prName:s,wordCID:a,gradeCID:i,directionID:l,passingGrade:u,combinationType:f,singleCount:d[0].singleCount,multipleCount:d[0].multipleCount,judgeCount:d[0].judgeCount,allotment:d[0].allotment,easyRatio:m[0].easy,mediumRatio:m[0].medium,difficultRatio:m[0].hard,detailList:D},!e.isEdit){t.next=16;break}return t.next=12,Object(c["v"])(O);case 12:w=t.sent,w.success&&(e.$notify({title:"成功",message:w.msg,type:"success"}),e.goback()),t.next=20;break;case 16:return t.next=18,Object(c["a"])(O);case 18:x=t.sent,x.success&&(e.$notify({title:"成功",message:x.msg,type:"success"}),e.goback());case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleChange:function(e,t){if("wordCID"===t){var n=this.professionOptions.find((function(t){return t.ID===e}));this.skillOptions=n.SubLst,this.directionOptions=[],this.form=Object(i["a"])(Object(i["a"])({},this.form),{},{gradeCID:"",directionID:""}),this.clearData()}else if("gradeCID"===t){var r=this.skillOptions.find((function(t){return t.ID===e}));this.directionOptions=r.SubLst,this.form=Object(i["a"])(Object(i["a"])({},this.form),{},{directionID:""}),this.clearData()}else"directionID"===t&&this.clearData()},openLibrary:function(){var e=this.form,t=e.wordCID,n=e.gradeCID,r=e.directionID,a=t&&n&&r;if(a)if(this.libraryList.length){this.libraryVisible=!0;var i=JSON.parse(JSON.stringify(this.defaultLibraryList));this.form.library.forEach((function(e){i=i.filter((function(t){return t.QBID!==e.QBID}))})),this.libraryList=i}else this.$message.warning("暂无题库，请更换鉴定工种/等级/方向试试看");else this.$message.error("请完整选择鉴定工种")},deleteSelectLibrary:function(e,t){this.form.library.splice(e,1);var n=this.removeQuestions(t);this.form.makeList=n},removeQuestions:function(e){return this.form.makeList.map((function(t){return t.length?t.filter((function(t){return t.qbid!==e})):t}))},clearSelection:function(){this.$refs.mkTable.$refs.elTable.clearSelection()},confirmSelection:function(){this.tmpSelection.length?(this.form.library=[].concat(Object(o["a"])(this.form.library),Object(o["a"])(this.tmpSelection)),this.libraryVisible=!1):this.$message.error("请至少选择一条题库")},handleSelectionChange:function(e){this.tmpSelection=e},handleOpen:function(e){var t=this;if(this.form.library.length<1)this.$message.error("请先选择应用题库");else{var n=this.form.library.map((function(e){return e.QBID}));0===this.form.make?Object(c["u"])({QBIDs:n}).then((function(e){t.cascaderOptions=Object(s["g"])(e.response.TreeList,"SubTree"),t.saveOptions=e.response.ClassCount,t.classVisible=!0})):this.bookVisible=!0}},handleDelete:function(e,t){0!==t.Status&&this.removeList.push(t),this.form.makeList[this.form.make].splice(e,1)},handleSelect:function(e){var t=this;this.$refs.selectForm.validate((function(n){if(n){var r=t.$refs[e].getCheckedNodes()[0].pathLabels,a=t.selectForm.selectValue,i=a[a.length-1],o=0,l=t.prid;if("classCascader"===e){var s=t.saveOptions.filter((function(e){return e.QCID===i}));s.forEach((function(e){t.checkExam(e.QBID,i)&&t.form.makeList[t.form.make].push({prrid:o,prid:l,qbid:e.QBID,qcid:i,text:r.join("/"),qbName:e.QBName,Questions:e.QuestionsCount,QuestionsCount:0,ratio:0,Status:0})}))}else if("bookCascader"===e){var u=t.saveOptions.find((function(e){return e.ChapterID===i}));t.checkExam(u.QBID,i)&&t.form.makeList[t.form.make].push({prrid:o,prid:l,qbid:u.QBID,qcid:i,text:r.join("/"),qbName:u.QBName,Questions:u.QuestionsCount,QuestionsCount:0,ratio:0,Status:0})}t.$refs.form.validateField("makeList")}}))},closeDialog:function(){this.cascaderOptions=[],this.selectForm={selectLibrary:"",selectValue:[]},this.classVisible=!1,this.bookVisible=!1},clearData:function(){this.form.library=[],this.form.makeList=[[],[]]},checkExam:function(e,t){var n=this.form.makeList[this.form.make].findIndex((function(n){return n.qbid===e&&n.qcid===t}));return!(n>-1)||(this.$message.error("新增不重复部分,[○･｀Д´･ ○]"),!1)},checkScore:function(e){var t=e.replace(/[^\d.]/g,"");t=t.replace(/^\./g,""),-1===t.indexOf(".")?t.length>2&&(t=t.slice(0,2)):t.split(".")[0].length>2&&(t=t.split(".")[0].slice(0,2)+"."+t.split(".")[1]),t=t.replace(/\.{2,}/g,""),t=t.replace(".","$#$").replace(/\./g,"").replace("$#$","."),t=t.replace(/^(\-)*(\d+)\.(\d).*$/,"$1$2.$3"),this.form.config[0].allotment=t},checkCount:function(e,t){var n=e.replace(/[^\d]/g,""),r=t.Questions;Number(n)>r&&(n=r),t.QuestionsCount=n,0!==t.Status&&(t.Status=2)},checkRatio:function(e,t){0!==t.Status&&(t.Status=2)}}},f=m,p=(n("e796"),n("2877")),b=Object(p["a"])(f,r,a,!1,null,"eda98a46",null);t["a"]=b.exports},e796:function(e,t,n){"use strict";var r=n("c35e"),a=n.n(r);a.a}}]);