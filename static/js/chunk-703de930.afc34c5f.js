(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-703de930"],{"37d6":function(e,t,a){"use strict";a.d(t,"o",(function(){return r})),a.d(t,"n",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return u})),a.d(t,"z",(function(){return c})),a.d(t,"r",(function(){return d})),a.d(t,"l",(function(){return m})),a.d(t,"y",(function(){return p})),a.d(t,"v",(function(){return f})),a.d(t,"h",(function(){return h})),a.d(t,"m",(function(){return b})),a.d(t,"k",(function(){return v})),a.d(t,"w",(function(){return D})),a.d(t,"u",(function(){return g})),a.d(t,"g",(function(){return P})),a.d(t,"t",(function(){return I})),a.d(t,"d",(function(){return S})),a.d(t,"j",(function(){return k})),a.d(t,"i",(function(){return x})),a.d(t,"q",(function(){return E})),a.d(t,"p",(function(){return y})),a.d(t,"x",(function(){return O})),a.d(t,"s",(function(){return j})),a.d(t,"b",(function(){return _}));var n=a("b775");function r(e){return Object(n["a"])({url:"api/ExamWork/GetSupervisonrList",method:"get",params:e})}function i(e){return Object(n["a"])({url:"api/ExamWork/GetSupervisor",method:"get",params:e})}function o(e){return Object(n["a"])({url:"api/Sys/CheckUserInfo",method:"get",noNoticeError:!0,params:e})}function l(e){return Object(n["a"])({url:"api/ExamWork/AddSupervisor",method:"post",data:e})}function s(e){return Object(n["a"])({url:"api/ExamWork/DisableSupervisorInfo",method:"get",params:e})}function u(e){return Object(n["a"])({url:"api/ExamWork/EnableSupervisorInfo",method:"get",params:e})}function c(e){return Object(n["a"])({url:"api/ExamWork/UpdateSupervisor",method:"post",data:e})}function d(e){return Object(n["a"])({url:"api/ExamWork/TheoryExaminationPlans",method:"get",params:e})}function m(e){return Object(n["a"])({url:"api/ExamWork/LoadTheoryExaminationPlan",method:"get",params:e})}function p(e){return Object(n["a"])({url:"api/ExamWork/SaveTheoryExaminationPlan",method:"post",data:e})}function f(e){return Object(n["a"])({url:"api/ExamWork/SaveBatchTheoryPlan",method:"post",useJSON:!0,data:e})}function h(e){return Object(n["a"])({url:"api/ExamWork/GenerateBatchTheoryPlan",method:"post",data:e})}function b(e){return Object(n["a"])({url:"api/ExamWork/SkillsExaminationPlans",method:"get",params:e})}function v(e){return Object(n["a"])({url:"api/ExamWork/LoadSkillsExaminationPlan",method:"get",params:e})}function D(e){return Object(n["a"])({url:"api/ExamWork/SaveSkillsExaminationPlan",method:"post",data:e})}function g(e){return Object(n["a"])({url:"api/ExamWork/SaveBatchSkillsPlan",method:"post",useJSON:!0,data:e})}function P(e){return Object(n["a"])({url:"api/ExamWork/GenerateBatchSkillsPlan",method:"post",data:e})}function I(e){return Object(n["a"])({url:"api/ExamWork/ReleaseExamPlans",method:"post",data:e})}function S(e){return Object(n["a"])({url:"api/ExamWork/DeleteExamPlans",method:"post",data:e})}function k(e){return Object(n["a"])({url:"api/ExamWork/GetExamPlanOrderedDetail",method:"get",params:e})}function x(e){return Object(n["a"])({url:"api/ExamWork/GetExamPlanForSupervisionPlan",method:"get",params:e})}function E(e){return Object(n["a"])({url:"api/ExamWork/GetSupervissionPlanList",method:"get",params:e})}function y(e){return Object(n["a"])({url:"api/ExamWork/GetSupervissionPlanDetail",method:"get",params:e})}function O(e){return Object(n["a"])({url:"api/ExamWork/SaveSupervissionPlan",method:"post",data:e})}function j(e){return Object(n["a"])({url:"api/ExamWork/PublishSupervissionPlan",method:"post",useJSON:!0,data:e})}function _(e){return Object(n["a"])({url:"api/ExamWork/CancelSupervissionPlan",method:"post",useJSON:!0,data:e})}},"8e54":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("detail",{attrs:{operate:"create"}})},r=[],i=a("fde7"),o={name:"SupervisionPlanDetail",components:{Detail:i["a"]}},l=o,s=a("2877"),u=Object(s["a"])(l,n,r,!1,null,null,null);t["default"]=u.exports},fde7:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar"}},[a("bar-space"),a("bar-cell",[a("el-button",{on:{click:e.goBack}},[e._v("返回")])],1),a("bar-cell",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")])],1)],1),a("div",{staticClass:"app-container"},[a("el-form",{ref:"elForm",attrs:{size:e.tableSize,model:e.elForm,rules:e.elFormRules,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"督导方式："}},[a("el-radio-group",{model:{value:e.elForm.Type,callback:function(t){e.$set(e.elForm,"Type",t)},expression:"elForm.Type"}},[a("el-radio",{attrs:{label:0}},[e._v("线下督导")]),a("el-radio",{attrs:{label:1}},[e._v("远程督导")])],1)],1),a("el-divider"),a("h5",{staticClass:"el-form-item__label",staticStyle:{margin:"0",float:"none","font-size":"16px"}},[e._v("督导安排")]),a("el-row",[a("el-col",{attrs:{span:4}},[a("area-select",{ref:"areaSelect",attrs:{"area-label":"督导地点：","area-prop":"ProvinceID","province-code":e.elForm.ProvinceID,"show-city":!1},on:{areaSelectChange:e.handleChangeArea}})],1),a("el-col",{attrs:{span:10}},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",plain:"",size:e.tableSize},on:{click:e.handleCreatePlan}},[e._v("添加考试场次")])],1)],1),a("table-body",{ref:"mkTable",attrs:{loading:e.tableLoading,columns:e.columns,"table-data":e.tableData,options:e.tableOptions,pagination:e.pagination,"has-padding":!1,"selection-row":e.selectionRow,"show-pagination-components":!1},on:{"multi-select-delete":e.batchDelete,"pagination-current-change":e.paginationCurrenChange,"pagination-size-change":e.paginationSizeChange}},[a("el-table-column",{attrs:{slot:"ExaminationTime",label:"考试时间",align:"center","min-width":"130px"},slot:"ExaminationTime",scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("parseTime")(a.StartDate,"{y}/{m}/{d} {h}:{i}:{s}"))+" - "+e._s(e._f("parseTime")(a.EndDate,"{y}/{m}/{d} {h}:{i}:{s}"))+" ")]}}])}),a("el-table-column",{attrs:{slot:"ProfessionNames",label:"鉴定工种/等级/方向","min-width":"120px","header-align":"center"},slot:"ProfessionNames",scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return e._l(n.ProfessionNames,(function(t,n){return a("div",{key:n},[e._v(e._s(t)),a("br")])}))}}])})],1),a("el-form-item",{staticStyle:{"margin-top":"32px"},attrs:{label:"选择督导员：",prop:"SupervisorID"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.elForm.SupervisorID,callback:function(t){e.$set(e.elForm,"SupervisorID",t)},expression:"elForm.SupervisorID"}},e._l(e.supervisorList,(function(e){return a("el-option",{key:e.ID,attrs:{label:e.UserName,value:e.ID}})})),1)],1),a("el-form-item",{attrs:{label:"状态："}},[e._v(" "+e._s(e.elForm.IsPublish?"已发布":"未发布")+" ")]),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")]),a("el-button",{on:{click:e.goBack}},[e._v("返回")])],1)],1)],1),a("PlanDialog",{attrs:{visible:e.showPlanDialog,"province-id":e.planDialogProvinceID,"province-name":e.planDialogProvinceName,"remove-ids":e.removeIds},on:{"update:visible":function(t){e.showPlanDialog=t},addPlans:e.handleAddPlans}})],1)},r=[],i=(a("99af"),a("4160"),a("caad"),a("d81d"),a("45fc"),a("a434"),a("d3b7"),a("2532"),a("159b"),a("2909")),o=a("5530"),l={data:function(){return{hasLoad:!1,elForm:{Type:0,ProvinceID:null,SupervisorID:null,Detail:[]},elFormRules:{ProvinceID:[{required:!0,message:"请选择省份"}],SupervisorID:[{required:!0,message:"请选择督导员"}]},supervisorList:[],removeItems:[],addItems:[],tableLoading:!1,tableData:[],tableOptions:{border:!0,headerCellClassName:"table-header-bg"},selectionRow:{align:"center"},pagination:{currentPage:1,pageSize:20,total:1},columns:[{title:"站点",key:"SiteName",align:"center"},{title:"考试时间",key:"ExaminationTime",slot:"ExaminationTime"},{title:"科目",key:"TypeName",align:"center"},{title:"已预约/可预约",key:"AppointmentStatistics",align:"center",formatter:function(e){var t="";return t="".concat(e.YiYuYue,"/").concat(e.KeYuYue),t}},{title:"考试状态",key:"StatusName",align:"center"},{title:"鉴定工种/等级/方向",key:"ProfessionNames",slot:"ProfessionNames"}],areaInfo:{},showPlanDialog:!1,planDialogProvinceID:null,planDialogProvinceName:null,removeIds:[]}}},s=a("2f62"),u=a("37d6"),c={name:"Detail",components:{BarCell:function(){return a.e("chunk-2d221e17").then(a.bind(null,"cbdf"))},BarSpace:function(){return a.e("chunk-2d2218de").then(a.bind(null,"cb9b"))},Sticky:function(){return a.e("chunk-2d210590").then(a.bind(null,"b804"))},AreaSelect:function(){return a.e("chunk-1bcfd332").then(a.bind(null,"a92d"))},TableBody:function(){return a.e("chunk-79d593e5").then(a.bind(null,"2c21"))},PlanDialog:function(){return a.e("chunk-11636d9c").then(a.bind(null,"dc00"))}},mixins:[l],props:{operate:{type:String,default:"detail"}},computed:Object(o["a"])({},Object(s["c"])({tableSize:function(e){return e.settings.tableSize}})),created:function(){this.doLoad()},methods:{doLoad:function(){this.doRefresh()},doRefresh:function(){var e=this;if("edit"===this.operate||"detail"===this.operate){var t=this.$route.params&&this.$route.params.id;this.tableLoading=!0,Object(u["p"])({planID:t}).then((function(t){e.tableLoading=!1,t.success&&(e.elForm=t.response,e.tableData=JSON.parse(JSON.stringify(t.response.Detail)))}))}},getSupervisorOptions:function(e){var t=this;e&&Object(u["o"])({provinceID:e,status:1,PageIndex:1,PageSize:99999}).then((function(e){e.success&&(t.supervisorList=e.data)}))},goBack:function(){this.$router.go(-1)},submitForm:function(){var e=this;this.$refs.elForm.validate((function(t){if(t){var a=e.elForm,n=a.PlanID,r=a.ProvinceID,o=a.Type,l=a.SupervisorID,s={Type:o,ProvinceID:r,SupervisorID:l};"create"===e.operate&&(s.SaveType=0,s.PlanID=0),"edit"===e.operate&&(s.SaveType=1,s.PlanID=n),s.Details=[].concat(Object(i["a"])(e.removeItems),Object(i["a"])(e.addItems)),Object(u["x"])(s).then((function(t){t.success&&(e.$message({message:"提交成功",type:"success"}),e.goBack())}))}}))},batchDelete:function(e){var t=this;this.$confirm("确定要批量删除这"+e.length+"条数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.forEach((function(e){t.tableData.forEach((function(a,n){a.PlanID===e.PlanID&&t.tableData.splice(n,1)})),t.updateRemoveArr(e)}))}))},batchAdd:function(e){var t,a=this;(t=this.tableData).push.apply(t,Object(i["a"])(e)),e.forEach((function(e){a.updateAddArr(e)}))},updateRemoveArr:function(e){var t=this,a=this.addItems.some((function(t){return t.PlanID===e.PlanID})),n=this.removeItems.some((function(t){return t.PlanID===e.PlanID}));a&&this.addItems.forEach((function(a,n){a.PlanID===e.PlanID&&t.addItems.splice(n)})),n||this.removeItems.push({Type:1,PlanID:e.PlanID,DetailID:e.SDetailID})},updateAddArr:function(e){var t=this,a=this.removeItems.some((function(t){return t.PlanID===e.PlanID})),n=this.addItems.some((function(t){return t.PlanID===e.PlanID})),r=this.elForm.Detail.some((function(t){return t.PlanID===e.PlanID}));a&&this.removeItems.forEach((function(a,n){a.PlanID===e.PlanID&&t.removeItems.splice(n,1)})),n||r||this.addItems.push({Type:0,PlanID:e.PlanID,ExamPlanID:e.PlanID})},handleAddPlans:function(e){var t=this,a=this.tableData.map((function(e){return e.PlanID}));e.forEach((function(e){a.includes(e.PlanID)||(t.tableData.push(e),t.updateAddArr(e))}))},handleCreatePlan:function(){var e=this.elForm.ProvinceID;if(e){this.showPlanDialog=!0;var t=this.areaInfo,a=t.provinceCode,n=t.provinceName;this.planDialogProvinceID=a,this.planDialogProvinceName=n,this.removeIds=this.tableData.map((function(e){return e.PlanID})),this.showPlanDialog=!0}else this.$message({message:"请选择省份",type:"warning"})},handleChangeArea:function(e){this.areaInfo=e,this.elForm.ProvinceID=e.provinceCode,this.hasLoad?this.tableData=[]:this.hasLoad=!0,this.removeItems=[],this.addItems=[],this.supervisorList=[],this.getSupervisorOptions(e.provinceCode)},paginationCurrenChange:function(e){this.pagination.currentPage=e,this.doRefresh()},paginationSizeChange:function(e){this.pagination.pageSize=e,this.doRefresh()}}},d=c,m=a("2877"),p=Object(m["a"])(d,n,r,!1,null,null,null);t["a"]=p.exports}}]);