(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6225a6da"],{2934:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return d})),n.d(t,"n",(function(){return f})),n.d(t,"m",(function(){return h})),n.d(t,"l",(function(){return b})),n.d(t,"d",(function(){return v}));var r=n("b775");function a(e){return Object(r["a"])({url:"api/Sys/CheckUserInfo",method:"get",noNoticeError:!0,params:e})}function i(e){return Object(r["a"])({url:"api/Sys/GetSelRoleList",method:"get",params:e})}function o(e){return Object(r["a"])({url:"api/Sys/GetEnableProfessionnalTitles",method:"get",params:e})}function s(e){return Object(r["a"])({url:"api/Sys/GetEnableExaminerProfessionnalTitles",method:"get",params:e})}function l(e){return Object(r["a"])({url:"api/Global/GetRegionList",method:"get",params:e})}function c(e){return Object(r["a"])({url:"api/Station/GetSelSites",method:"get",params:e})}function u(e){return Object(r["a"])({url:"api/Sys/EnableProfessionList",method:"get",params:e})}function m(e){return Object(r["a"])({url:"api/Examination/LoadQuestionBankOptions",method:"get",params:e})}function p(e){return Object(r["a"])({url:"api/Sys/GetEnableEQLanguages",method:"get",params:e})}function d(e){return Object(r["a"])({url:"api/Station/EnableExamRoomLst",method:"get",params:e})}function f(e){return Object(r["a"])({url:"images/Upload/TempPic",method:"post",data:e,multiple:!0})}function h(e){return Object(r["a"])({url:"images/Upload/TempFile",method:"post",data:e,multiple:!0})}function b(e){return Object(r["a"])({url:"api/images/Upload/NewPic",method:"post",data:e,multiple:!0})}function v(e){return Object(r["a"])({url:"api/Station/EnableExaminerInfos",method:"get",params:e})}},"2a1d":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("search-panel",{model:{value:e.searchPanelActive,callback:function(t){e.searchPanelActive=t},expression:"searchPanelActive"}},[n("bar",{attrs:{slot:"title"},slot:"title"},[n("bar-space"),n("bar-cell",[n("el-button",{attrs:{icon:"el-icon-refresh",size:e.tableSize},on:{click:e.doRefresh}},[e._v("刷新")])],1),n("bar-cell",{directives:[{name:"permission",rawName:"v-permission",value:"create",expression:"'create'"}]},[n("el-button",{attrs:{type:"danger",size:e.tableSize},on:{click:e.doBatchCreate}},[e._v("批量添加计划")])],1),n("bar-cell",{directives:[{name:"permission",rawName:"v-permission",value:"create",expression:"'create'"}]},[n("el-button",{attrs:{type:"danger",size:e.tableSize},on:{click:e.doCreate}},[e._v("单独添加计划")])],1)],1),n("el-form",{ref:"searchForm",attrs:{"label-position":"top",inline:"",size:e.tableSize},model:{value:e.searchForm,callback:function(t){e.searchForm=t},expression:"searchForm"}},["Department"===e.role||"Guidance"===e.role?n("area-select",{attrs:{"area-label":"省份","show-city":!1,"province-code":e.searchForm.ProvinceID},on:{areaSelectChange:e.searchFormAreaChange}}):e._e(),"Station"!==e.role?n("el-form-item",{attrs:{label:"鉴定站",prop:"SiteID"}},[n("el-select",{attrs:{disabled:e.selectDisabled,placeholder:e.searchForm.ProvinceID?"请选择":"请先选择省份"},model:{value:e.searchForm.SiteID,callback:function(t){e.$set(e.searchForm,"SiteID",t)},expression:"searchForm.SiteID"}},e._l(e.provinceOptions,(function(e){return n("el-option",{key:e.SiteID,attrs:{label:e.SiteName,value:e.SiteID}})})),1)],1):e._e(),n("profession-skill-select",{attrs:{label:"鉴定工种/等级/方向","first-level":e.searchForm.ProfessionID,"second-level":e.searchForm.gradeCID,"third-level":e.searchForm.directionID,"show-third-level":!0},on:{selectChange:e.selectChange,getOptions:e.getOptions}}),n("el-form-item",{attrs:{label:"日期范围"}},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.searchForm.time,callback:function(t){e.$set(e.searchForm,"time",t)},expression:"searchForm.time"}})],1),"Site"===e.role||"Station"===e.role?n("el-form-item",{attrs:{label:"发布状态"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.ReleaseStatus,callback:function(t){e.$set(e.searchForm,"ReleaseStatus",t)},expression:"searchForm.ReleaseStatus"}},[n("el-option",{attrs:{label:"发布",value:1}}),n("el-option",{attrs:{label:"停用",value:0}})],1)],1):e._e(),n("el-form-item",{attrs:{label:"考试状态"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.ExaminationStatus,callback:function(t){e.$set(e.searchForm,"ExaminationStatus",t)},expression:"searchForm.ExaminationStatus"}},[n("el-option",{attrs:{label:"未开始",value:0}}),n("el-option",{attrs:{label:"进行中",value:1}}),n("el-option",{attrs:{label:"已取消",value:2}}),n("el-option",{attrs:{label:"已结束",value:3}})],1)],1),n("el-form-item",{attrs:{label:"属性"}},[n("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.PlanType,callback:function(t){e.$set(e.searchForm,"PlanType",t)},expression:"searchForm.PlanType"}},[n("el-option",{attrs:{label:"常规",value:0}}),n("el-option",{attrs:{label:"复鉴",value:1}}),n("el-option",{attrs:{label:"转移",value:2}})],1)],1),n("el-form-item",{attrs:{label:"操作"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchFormSubmit}},[e._v("查询")]),n("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.searchFormReset}},[e._v("清空")])],1)],1)],1),n("table-body",{ref:"mkTable",attrs:{loading:e.tableLoading,columns:e.columns,"table-data":e.tableData,"index-row":e.indexRow,options:e.tableOptions,pagination:e.pagination},on:{"pagination-current-change":e.paginationCurrenChange,"pagination-size-change":e.paginationSizeChange}},[n("el-table-column",{attrs:{slot:"ExaminationIdentificationTypes",label:"鉴定工种/等级/方向","header-align":"center","min-width":"300"},slot:"ExaminationIdentificationTypes",scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[n("table-popover",{attrs:{arr:t.ExaminationIdentificationTypes,width:380,"intercept-len":4}})]}}])}),n("el-table-column",{attrs:{slot:"Status",label:"状态",align:"center","min-width":"60"},slot:"Status",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.Status?n("span",{staticClass:"text-green"},[e._v("发布")]):e._e(),r.Status?e._e():n("span",{staticClass:"text-red"},[e._v("停用")])]}}])}),n("el-table-column",{attrs:{slot:"ExaminationStatus",label:"考试状态",align:"center","min-width":"80"},slot:"ExaminationStatus",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.row;return[r.ExaminationStatus?e._e():n("span",{staticClass:"text-red"},[e._v("未开始")]),1===r.ExaminationStatus?n("span",{staticClass:"text-blue"},[e._v("进行中")]):e._e(),2===r.ExaminationStatus?n("span",[e._v("已取消")]):e._e(),3===r.ExaminationStatus?n("span",{staticClass:"text-black-40"},[e._v("已结束")]):e._e()]}}])}),n("el-table-column",{attrs:{slot:"operate",label:"操作","min-width":"140",align:"center",fixed:"right"},slot:"operate",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index,a=t.row;return[n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"edit",expression:"'edit'"}],attrs:{type:"primary"},on:{click:function(t){return e.handleEdit(a)}}},[e._v("修改")]),a.Status?e._e():n("switch-status",{directives:[{name:"permission",rawName:"v-permission",value:"enable",expression:"'enable'"}],attrs:{row:a,str:a.PlanName,"status-key":"Status","status-str":["发布","停用"]},on:{"on-switch":e.handleSwitch}}),a.Status?e._e():n("popconfirm-link",{directives:[{name:"permission",rawName:"v-permission",value:"delete",expression:"'delete'"}],attrs:{title:"确定要删除"+a.PlanName+"吗？"},on:{"do-confirm":function(t){return e.handleDelete(r,a)}}}),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"transfer",expression:"'transfer'"}],attrs:{type:"danger"},on:{click:function(t){return e.handleShift(a)}}},[e._v("转移本场次考生")]),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"detail",expression:"'detail'"}],attrs:{type:"primary"},on:{click:function(t){return e.handleDetail(a)}}},[e._v("考试预约情况")]),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"disable",expression:"'disable'"}],attrs:{type:"danger"},on:{click:function(t){return e.handleCancel(a)}}},[e._v("取消考试计划")]),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"upload",expression:"'upload'"}],attrs:{type:"danger"},on:{click:function(t){return e.handleUpload(a)}}},[e._v("上传考评报告")]),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:"look",expression:"'look'"}],attrs:{type:"primary"},on:{click:function(t){return e.handleLook(a)}}},[e._v("查看考评报告")])]}}])})],1),n("el-dialog",{attrs:{title:e.isEdit?"编辑计划":e.isBatch?"批量添加计划":"单独添加计划",visible:e.batchFormVisible,"before-close":e.batchFormClose,"destroy-on-close":""},on:{"update:visible":function(t){e.batchFormVisible=t}}},[n("el-form",{ref:"batchForm",attrs:{model:e.batchForm,size:e.tableSize,"label-position":"right","label-width":"142px"}},[e.isBatch?e._e():n("el-form-item",{attrs:{label:"考试名称",prop:"PlanName",rules:[{required:!0,message:"请填写",trigger:"change"}]}},[n("el-input",{model:{value:e.batchForm.PlanName,callback:function(t){e.$set(e.batchForm,"PlanName",t)},expression:"batchForm.PlanName"}})],1),e.isBatch?e._e():n("el-form-item",{attrs:{label:"考试日期",prop:"datetime",rules:[{required:!0,message:"请选择日期时间",trigger:"change"}]}},[n("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间","picker-options":e.singlePickerOptions},model:{value:e.batchForm.datetime,callback:function(t){e.$set(e.batchForm,"datetime",t)},expression:"batchForm.datetime"}})],1),e.isBatch?n("el-form-item",{attrs:{label:"考试周期",prop:"time",rules:[{required:!0,type:"array",message:"请选择考试周期",trigger:"blur"}]}},[n("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.batchForm.time,callback:function(t){e.$set(e.batchForm,"time",t)},expression:"batchForm.time"}})],1):e._e(),e.isBatch?n("el-form-item",{attrs:{label:"考试日",prop:"SelWeeks",rules:[{required:!0,type:"array",message:"请至少选择一个考试日",trigger:"change"}]}},[e.weeksArr.length?e._e():n("span",[e._v("请先选择考试周期")]),n("el-checkbox-group",{model:{value:e.batchForm.SelWeeks,callback:function(t){e.$set(e.batchForm,"SelWeeks",t)},expression:"batchForm.SelWeeks"}},e._l(e.weeksArr,(function(t){return n("el-checkbox-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1):e._e(),n("el-row",[e.isBatch?n("el-col",{attrs:{span:10}},[n("el-form-item",{attrs:{label:"考试频次",prop:"Frequency",rules:[{required:!0,message:"请输入",trigger:"blur"},{validator:e.greaterThanZero,trigger:"blur"}]}},[n("el-input",{attrs:{placeholder:"请输入"},model:{value:e.batchForm.Frequency,callback:function(t){e.$set(e.batchForm,"Frequency",e._n(t))},expression:"batchForm.Frequency"}},[n("template",{slot:"prepend"},[e._v("每天")]),n("template",{slot:"append"},[e._v("场")])],2)],1)],1):e._e(),n("el-col",{attrs:{span:10}},[n("el-form-item",{attrs:{label:"考试时长",prop:"Duration",rules:[{required:!0,message:"请输入",trigger:"blur"},{validator:e.greaterThanZero,trigger:"blur"}]}},[n("el-input",{attrs:{placeholder:"请输入"},model:{value:e.batchForm.Duration,callback:function(t){e.$set(e.batchForm,"Duration",e._n(t))},expression:"batchForm.Duration"}},[n("template",{slot:"append"},[e._v("分钟")])],2)],1)],1),e.isBatch?n("el-col",{attrs:{span:3,offset:1}},[n("el-button",{attrs:{size:e.tableSize,type:"primary",plain:"",disabled:e.generateBtnDisabled},on:{click:e.handleGenerate}},[e._v("生成")])],1):e._e()],1),e.isBatch?n("el-form-item",{attrs:{label:"开始时间"}},[e.batchForm.SeasonList.length?n("el-row",e._l(e.batchForm.SeasonList,(function(t,r){return n("el-col",{key:r,staticClass:"season-item",attrs:{span:8,flex:"cross:center"}},[n("span",{attrs:{"flex-box":"0"}},[e._v("第"+e._s(t.label)+"场：")]),n("el-time-select",{attrs:{"picker-options":{start:"00:00",step:"00:15",end:"23:45"},placeholder:"选择时间","flex-box":"1"},model:{value:t.Time,callback:function(n){e.$set(t,"Time",n)},expression:"item.Time"}})],1)})),1):n("span",[e._v(" 请点击“ "),n("span",{staticClass:"text-blue"},[e._v("生成")]),e._v(" ”按钮 ")])],1):e._e(),n("el-form-item",{attrs:{label:"选择考场",prop:"ERIID",rules:[{required:!0,message:"请选择",trigger:"change"}]}},[n("el-select",{attrs:{filterable:"",placeholder:"请选择合适的考场"},on:{change:e.selectERIID},model:{value:e.batchForm.ERIID,callback:function(t){e.$set(e.batchForm,"ERIID",t)},expression:"batchForm.ERIID"}},e._l(e.roomOptions,(function(e){return n("el-option",{key:e.ERIID,attrs:{label:"（"+e.ERNumber+"）"+e.ERName,value:e.ERIID}})})),1)],1),e.isBatch?e._e():n("el-form-item",{attrs:{label:"可考人数"}},[n("strong",[e._v(e._s(e.batchForm.ERINumber))]),e._v("位 ")]),n("el-form-item",{attrs:{label:"鉴定工种/等级/方向",prop:"EITypeList",rules:[{required:!0,type:"array",message:"请至少添加一种“鉴定工种/等级/方向”"}]}},[n("el-radio-group",{on:{change:function(t){return e.handleChange(t,"ProfessionID")}},model:{value:e.formEITypItem.ProfessionID,callback:function(t){e.$set(e.formEITypItem,"ProfessionID",t)},expression:"formEITypItem.ProfessionID"}},e._l(e.formProfessionOptions,(function(t){return n("el-radio",{key:t.ID,attrs:{label:t.ID,border:""}},[e._v(e._s(t.Name))])})),1)],1),n("el-form-item",[n("el-row",[n("el-col",{attrs:{span:7}},[n("el-select",{attrs:{filterable:"",placeholder:e.formSkillOptions.length?"请选择鉴定等级":"请先选择职业工种",disabled:!e.formSkillOptions.length},on:{change:function(t){return e.handleChange(t,"SkillID")}},model:{value:e.formEITypItem.SkillID,callback:function(t){e.$set(e.formEITypItem,"SkillID",t)},expression:"formEITypItem.SkillID"}},e._l(e.formSkillOptions,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})})),1)],1),n("el-col",{attrs:{span:7}},[n("el-select",{attrs:{filterable:"",placeholder:e.formDirectionOptions.length?"请选择鉴定方向":"请先选择技能等级",disabled:!e.formDirectionOptions.length},on:{change:function(t){return e.handleChange(t,"DirectionID")}},model:{value:e.formEITypItem.DirectionID,callback:function(t){e.$set(e.formEITypItem,"DirectionID",t)},expression:"formEITypItem.DirectionID"}},e._l(e.formDirectionOptions,(function(e){return n("el-option",{key:e.ID,attrs:{label:e.Name,value:e.ID}})})),1)],1),n("el-col",{attrs:{span:3}},[n("el-button",{attrs:{size:e.tableSize,type:"primary",plain:""},on:{click:e.confirmThree}},[e._v("添加")])],1)],1),n("div",e._l(e.batchForm.EITypeList,(function(t,r){return n("el-tag",{key:r,attrs:{closable:"",effect:"plain","disable-transitions":!1},on:{close:function(t){return e.handleClose(r)}}},[e._v(e._s(t.ProfessionName))])})),1)],1),n("el-form-item",{attrs:{label:"考评组长",prop:"ExaminerID",rules:[{required:!0,message:"请选择",trigger:"change"}]}},[n("el-select",{attrs:{filterable:"",placeholder:e.formEITypItem.ProfessionID?"请选择考评组长":"请先选择职业工种",disabled:!e.formEITypItem.ProfessionID},model:{value:e.batchForm.ExaminerID,callback:function(t){e.$set(e.batchForm,"ExaminerID",t)},expression:"batchForm.ExaminerID"}},e._l(e.UserOptions,(function(e){return n("el-option",{key:e.ExaminerID,attrs:{label:e.UserName,value:e.ExaminerID}})})),1)],1),n("el-form-item",{attrs:{label:"预约截止时间",prop:"TimeCount",rules:[{required:!0,message:"请输入",trigger:"blur"},{validator:e.greaterThanZero,trigger:"blur"}]}},[n("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:e.batchForm.TimeCount,callback:function(t){e.$set(e.batchForm,"TimeCount",t)},expression:"batchForm.TimeCount"}},[n("template",{slot:"prepend"},[e._v("考前")]),n("template",{slot:"append"},[e._v("天")])],2)],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.isBatch?n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("生成计划")]):n("el-button",{attrs:{type:"primary"},on:{click:e.submitSingleForm}},[e._v("提交")])],1),n("el-dialog",{attrs:{width:"40%",title:"确认计划",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[n("el-form",[n("p",{staticClass:"article"},[e._v(" "+e._s(e._f("parseTime")(e.batchForm.time[0],"{y}-{m}-{d}"))+" 至 "+e._s(e._f("parseTime")(e.batchForm.time[1],"{y}-{m}-{d}"))+" 共排列考试计划 "),n("strong",{staticClass:"text-red"},[e._v(e._s(e.resultList.length))]),e._v(" 场，可考试人数： "),n("strong",{staticClass:"text-red"},[e._v(e._s(e.totalNumber))]),e._v(" 人。 ")]),n("p",{staticClass:"article"},[e._v(" 选择考场【 "),n("strong",[e._v(e._s(e.batchForm.ERIName))]),e._v(" 】，该考场每次可预约 "),n("strong",{staticClass:"text-red"},[e._v(e._s(e.batchForm.ERINumber))]),e._v(" 人， 每场考试时长为： "),n("strong",[e._v(e._s(e.batchForm.Duration)+"分钟")]),e._v("。 ")]),n("p",{staticClass:"article mb-0"},[n("strong",[e._v("已选择 鉴定工种/等级/方向：")])]),n("div",{staticClass:"article mb-10",staticStyle:{"padding-left":"28px"}},e._l(e.batchForm.EITypeList,(function(t,r){return n("el-tag",{key:r},[e._v(e._s(t.ProfessionName))])})),1),n("table-body",{attrs:{"has-padding":!1,columns:e.timeColumns,"table-data":e.resultList,options:e.tableOptions}},[n("el-table-column",{attrs:{slot:"operate",label:"操作","min-width":"80",align:"center"},slot:"operate",scopedSlots:e._u([{key:"default",fn:function(t){var r=t.$index,a=t.row;return[n("popconfirm-link",{attrs:{title:"确定要删除该时间段吗？"},on:{"do-confirm":function(t){return e.handleRemoveTime(r,a)}}})]}}])})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-link",{staticClass:"mr-15",on:{click:function(t){e.innerVisible=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.submitInnerForm}},[e._v("确认生成")])],1)],1)],1)],1)},a=[],i=(n("99af"),n("a623"),n("4de4"),n("7db0"),n("c740"),n("4160"),n("caad"),n("a15b"),n("d81d"),n("13d5"),n("45fc"),n("a434"),n("a9e3"),n("b64b"),n("d3b7"),n("ac1f"),n("1276"),n("159b"),n("96cf"),n("1da1")),o=n("5530"),s=n("2f62"),l=n("37d6"),c=n("2934"),u=n("ed08"),m={data:function(){return{role:"",searchPanelActive:!0,searchForm:{ProvinceID:null,SiteID:null,time:[],ReleaseStatus:null,ExaminationStatus:null,PlanType:null,ProfessionID:null,gradeCID:null,directionID:null},tableLoading:!1,indexRow:{title:"#",align:"center",width:"50px"},columns:[{title:"考试计划名称",key:"PlanName",headerAlign:"center",minWidth:150},{title:"开考时间",key:"StarTime",align:"center",minWidth:140,formatter:function(e,t,n,r){return Object(u["e"])(e.StarTime,"{y}-{m}-{d} {h}:{i}")}},{title:"考场名称",key:"ERName",align:"center",minWidth:130},{title:"鉴定工种/等级/方向",key:"ExaminationIdentificationTypes",slot:"ExaminationIdentificationTypes"},{title:"已预约/可预约",key:"ReservedCount",align:"center",minWidth:100,formatter:function(e,t,n,r){return"".concat(e.ReservedCount,"/").concat(e.EnableCount)}},{title:"考评员",key:"people",align:"center",minWidth:100},{title:"考评组长",key:"UserName",align:"center",minWidth:100},{title:"属性",key:"PlanType",align:"center",minWidth:100,formatter:function(e,t,n,r){var a="";switch(e.PlanType){case 0:a="常规";break;case 1:a="复鉴";break;case 2:a="转移";break}return a}},{title:"状态",key:"Status",slot:"Status"},{title:"考试状态",key:"ExaminationStatus",slot:"ExaminationStatus"}],tableData:[],tableOptions:{border:!0,headerCellClassName:"table-header-bg"},pagination:{currentPage:1,pageSize:20,total:1},selectDisabled:!1,provinceOptions:[],formProfessionOptions:[],formSkillOptions:[],formDirectionOptions:[],formEITypItem:{ProfessionID:null,ProfessionName:"",SkillID:null,SkillIDName:"",DirectionID:null,DirectionName:""},roomOptions:[],isBatch:!1,isEdit:!1,SkillsPlanID:0,batchForm:{PlanName:"",datetime:"",time:[],SelWeeks:[],Frequency:1,Duration:90,SeasonList:[],ERIID:null,ExaminerID:null,ERIName:"",ERINumber:0,EITypeList:[],TimeCount:1,TimeType:2},batchFormVisible:!1,innerVisible:!1,pickerOptions:{onPick:this.onPickTime,disabledDate:function(e){return e.getTime()<Date.now()}},singlePickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()}},weeksArr:[],defaultEITypeList:[],resultList:[],totalNumber:0,timeColumns:[{title:"开考时间",key:"StarDate",align:"center",minWidth:140,formatter:function(e,t,n,r){return Object(u["e"])(e.StarDate,"{y}-{m}-{d} {h}:{i}")}}],UserOptions:[],defaultUserOptions:[]}}},p=n("61f7"),d={name:"ExaminationSkillPlan",components:{AreaSelect:function(){return n.e("chunk-2d209560").then(n.bind(null,"a92d"))},Bar:function(){return n.e("chunk-2d0bac10").then(n.bind(null,"390d"))},BarCell:function(){return n.e("chunk-2d221e17").then(n.bind(null,"cbdf"))},BarSpace:function(){return n.e("chunk-2d2218de").then(n.bind(null,"cb9b"))},SearchPanel:function(){return n.e("chunk-c808d2de").then(n.bind(null,"978e"))},TableBody:function(){return n.e("chunk-79d593e5").then(n.bind(null,"2c21"))},SwitchStatus:function(){return n.e("chunk-2d0e9431").then(n.bind(null,"8d7f"))},PopconfirmLink:function(){return n.e("chunk-f9b7a5e6").then(n.bind(null,"1417"))},TablePopover:function(){return n.e("chunk-90416b0c").then(n.bind(null,"4ab8"))},ProfessionSkillSelect:function(){return n.e("chunk-2d0e1b55").then(n.bind(null,"7c1d"))}},mixins:[m],computed:Object(o["a"])(Object(o["a"])({},Object(s["c"])({tableSize:function(e){return e.settings.tableSize}})),{},{generateBtnDisabled:function(){var e=this.batchForm,t=e.Frequency,n=e.Duration,r=!0;return t&&t>0&&n&&n>0&&(r=!1),r},showOperate:function(){var e=["Station","Site"];return e.includes(this.role)}}),watch:{"searchForm.ProvinceID":{handler:function(e){null!==e&&(this.selectDisabled=!1,this.placeholder="请选择",this._getSelSites(e))},immediate:!0}},created:function(){var e=this.$store.getters.mainRoles;this.role=e;var t=["Team","Site"];t.includes(e)&&(this.searchForm.ProvinceID=0);var n=["Station","Site"];n.includes(e)||(this.searchForm.ReleaseStatus=1),this.doLoad()},methods:{_getSelSites:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(c["k"])({ProvinceID:e});case 2:r=n.sent,r.success&&(t.provinceOptions=r.response);case 4:case"end":return n.stop()}}),n)})))()},_getEnableExamRoomLst:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.roomOptions.length){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(c["c"])({ERType:1});case 4:n=t.sent,n.success&&(e.roomOptions=n.response);case 6:case"end":return t.stop()}}),t)})))()},_getEnableExaminerInfos:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.defaultUserOptions.length){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Object(c["d"])();case 4:n=t.sent,n.success&&(e.defaultUserOptions=n.response);case 6:case"end":return t.stop()}}),t)})))()},selectChange:function(e){this.searchForm=Object(o["a"])(Object(o["a"])({},this.searchForm),{},{ProfessionID:e.firstLevel,gradeCID:e.secondLevel,directionID:e.thirdLevel})},getOptions:function(e){this.formProfessionOptions=e;var t=[];e.forEach((function(e){var n=e.ID,r=e.Name;e.SubLst&&e.SubLst.length&&e.SubLst.forEach((function(e){var a=e.ID,i=e.Name;e.SubLst&&e.SubLst.length&&e.SubLst.forEach((function(e){t.push({ProfessionID:n,SkillID:a,DirectionID:e.ID,ProfessionName:"".concat(r,"-").concat(i,"-").concat(e.Name)})}))}))})),this.defaultEITypeList=t},doRefresh:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i,s,c,u,m,p,d,f,h,b;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,n=e.pagination,r=n.currentPage,a=n.pageSize,i=e.searchForm,s=i.ProvinceID,c=i.SiteID,u=i.time,m=i.ExaminationStatus,p=i.ReleaseStatus,d=i.PlanType,f=i.ProfessionID,h={ProvinceID:s||0,SiteID:c||-1,StarDate:u.length?u[0]:"",EndDate:u.length?u[1]:"",ExaminationStatus:m||-1,ReleaseStatus:null===p?-1:p,PlanType:null===d?-1:d,ProfessionID:f||0,PageIndex:r,PageSize:a},t.next=5,Object(l["m"])(h);case 5:b=t.sent,e.tableLoading=!1,b.success&&(console.log("res",b),e.tableData=b.data,e.pagination=Object(o["a"])(Object(o["a"])({},e.pagination),{},{currentPage:b.page,total:b.dataCount}));case 8:case"end":return t.stop()}}),t)})))()},doLoad:function(){this.doRefresh()},searchFormSubmit:function(){this.doRefresh()},searchFormReset:function(){this.searchForm={ProvinceID:null,SiteID:null,time:[],ReleaseStatus:null,ExaminationStatus:null,PlanType:null,ProfessionID:null,gradeCID:null,directionID:null}},doCreate:function(){this.isEdit=!1,this.isBatch=!1,this.commonCreate()},doBatchCreate:function(){this.isEdit=!1,this.isBatch=!0,this.commonCreate()},commonCreate:function(){this.batchFormVisible=!0,this._getEnableExamRoomLst(),this._getEnableExaminerInfos()},handleEdit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a,i,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(l["k"])({PlanID:e.SkillsPlanID});case 2:r=n.sent,r.success&&(console.log("handleEdit",r),a=r.response,t.isEdit=!0,t.isBatch=!1,t.SkillsPlanID=e.SkillsPlanID,t.commonCreate(),t.batchForm=Object(o["a"])(Object(o["a"])({},t.batchForm),{},{PlanName:a.PlanName,datetime:Object(u["e"])(a.StarTime,"{y}-{m}-{d} {h}:{i}"),Duration:a.Duration,ERIID:a.ERIID,ExaminerID:a.ExaminerID,TimeType:a.TimeType,TimeCount:a.TimeCount,EITypeList:a.EITypeList}),i=t.formProfessionOptions.find((function(e){return e.ID===a.ProfessionID})),t.formSkillOptions=i.SubLst,s=t.defaultUserOptions.filter((function(e){return e.ProfessionID===a.ProfessionID})),t.UserOptions=s,t.formEITypItem=Object(o["a"])(Object(o["a"])({},t.formEITypItem),{},{ProfessionID:a.ProfessionID,ProfessionName:i.Name}));case 4:case"end":return n.stop()}}),n)})))()},handleSwitch:function(e,t,n,r){"confirm"===t?(n.confirmButtonLoading=!0,n.confirmButtonText="提交中...",e.Status):r()},handleCancel:function(){},handleDelete:function(){},handleShift:function(){},handleDetail:function(){},handleUpload:function(){},handleLook:function(){},searchFormAreaChange:function(e){this.searchForm.ProvinceID=e.provinceCode},onPickTime:function(e){var t=e.maxDate,n=e.minDate;t&&(this.weeksArr=this.getWeeksFromDate(n,t))},handleGenerate:function(){var e=this.batchForm.Frequency,t=this.batchForm.Duration,n=Math.floor(24/(t/60));e>n?this.$message.error("".concat(t,"分钟每天最多设置").concat(n,"场")):this.batchForm.SeasonList=Array(e).join(",").split(",").map((function(e,t){var n=t+1;return{label:n<10?"0".concat(n):"".concat(n),Num:n,Time:""}}))},handleChange:function(e,t){if("ProfessionID"===t){var n=this.formProfessionOptions.find((function(t){return t.ID===e}));this.formSkillOptions=n.SubLst,this.formDirectionOptions=[],this.formEITypItem=Object(o["a"])(Object(o["a"])({},this.formEITypItem),{},{ProfessionName:n.Name,SkillID:null,SkillIDName:"",DirectionID:null,DirectionName:""});var r=this.defaultUserOptions.filter((function(t){return t.ProfessionID===e}));this.UserOptions=r,this.batchForm=Object(o["a"])(Object(o["a"])({},this.batchForm),{},{EITypeList:[],ExaminerID:null})}else if("SkillID"===t){var a=this.formSkillOptions.find((function(t){return t.ID===e}));this.formDirectionOptions=a.SubLst,this.formEITypItem=Object(o["a"])(Object(o["a"])({},this.formEITypItem),{},{SkillIDName:a.Name,DirectionID:null,DirectionName:""})}else if("DirectionID"===t){var i=this.formDirectionOptions.find((function(t){return t.ID===e}));this.formEITypItem=Object(o["a"])(Object(o["a"])({},this.formEITypItem),{},{DirectionName:i.Name})}},selectERIID:function(e){var t=this.roomOptions.find((function(t){return t.ERIID===e}));this.batchForm.ERIName=t.ERName,this.batchForm.ERINumber=t.EnableCount},confirmThree:function(){var e=this,t=Object.keys(this.formEITypItem).every((function(t){return e.formEITypItem[t]}));if(t){var n=this.formEITypItem,r=n.ProfessionID,a=n.ProfessionName,i=n.SkillID,o=n.SkillIDName,s=n.DirectionID,l=n.DirectionName;this.batchForm.EITypeList.some((function(e){return e.ProfessionID===r&&e.SkillID===i&&e.DirectionID===s}))?this.$message.error("已经存在，不能重复添加！"):this.batchForm.EITypeList.push({ProfessionID:r,SkillID:i,DirectionID:s,ProfessionName:"".concat(a,"-").concat(o,"-").concat(l)})}else this.$message.error("请完整选择 鉴定工种/等级/方向")},handleClose:function(e){this.batchForm.EITypeList.splice(e,1)},handleRemoveTime:function(e,t){this.resultList.splice(e,1),this.resultList.length<1&&(this.innerVisible=!1)},batchFormClose:function(){this.batchFormVisible=!1,this.batchFormReset()},submitForm:function(){var e=this;this.$refs.batchForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var r,a,i,o,s,c,u,m,p,d,f,h,b,v;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:if(r=e.batchForm,a=r.time,i=r.SelWeeks,o=r.Frequency,s=r.Duration,c=r.SeasonList,u=r.ERIID,m=r.ExaminerID,p=r.EITypeList,d=r.TimeCount,f=r.TimeType,!(c.length<1)){t.next=6;break}return e.$message.error("请“生成”考试开始时间"),t.abrupt("return");case 6:if(!c.some((function(e){return!e.Time}))){t.next=9;break}return e.$message.error("请给每场场次设置开始时间"),t.abrupt("return");case 9:if(!(p.length<1)){t.next=12;break}return e.$message.error("请至少添加一种“鉴定工种/等级/方向”"),t.abrupt("return");case 12:return h=c.map((function(e){return{Num:e.Num,Time:e.Time}})),b={StarDate:a[0],EndDate:a[1],SelWeeks:i,Frequency:o,Duration:s,SeasonList:h,ERIID:u,ExaminerID:m,TimeType:f,TimeCount:d,EITypeList:p},t.next=16,Object(l["g"])(b);case 16:v=t.sent,v.success&&(e.resultList=v.response,e.innerVisible=!0,e.totalNumber=e.resultList.map((function(e){return Number(e.SeatCount)})).reduce((function(e,t){return e+t})));case 18:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},submitSingleForm:function(){var e=this;this.$refs.batchForm.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var r,a,i,o,s,c,u,m,p,d,f,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n){t.next=2;break}return t.abrupt("return");case 2:if(r=e.batchForm,a=r.PlanName,i=r.datetime,o=r.Duration,s=r.ERIID,c=r.ExaminerID,u=r.EITypeList,m=r.TimeCount,p=r.TimeType,d=e.SkillsPlanID,!(u.length<1)){t.next=6;break}return e.$message.error("请至少添加一种“鉴定工种/等级/方向”"),t.abrupt("return");case 6:return f={SkillsPlanID:d,PlanName:a,StarTime:i,Duration:o,ERIID:s,ExaminerID:c,TimeType:p,TimeCount:m,EITypeList:u},t.next=9,Object(l["w"])(f);case 9:h=t.sent,h.success&&(e.$notify({title:"成功",message:h.msg,type:"success"}),e.batchFormClose(),e.doRefresh());case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},batchFormReset:function(){this.SkillsPlanID=0,this.batchForm={PlanName:"",datetime:"",time:[],SelWeeks:[],Frequency:1,Duration:90,SeasonList:[],ERIID:null,ExaminerID:null,ERIName:"",ERINumber:0,EITypeList:[],TimeCount:1,TimeType:2},this.formEITypItem={ProfessionID:null,ProfessionName:"",SkillID:null,SkillIDName:"",DirectionID:null,DirectionName:""},this.weeksArr=[]},submitInnerForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["u"])(e.resultList);case 2:n=t.sent,console.log("res",n),n.success&&(e.$notify({title:"成功",message:n.msg,type:"success"}),e.innerVisible=!1,e.batchFormClose(),e.doRefresh());case 5:case"end":return t.stop()}}),t)})))()},getWeeksFromDate:function(e,t){var n=new Date(e),r=new Date(t),a=[],i=function(){var e=n.getDay();a.findIndex((function(t){return t.value===e}))<0&&a.push({value:e,label:["周日","周一","周二","周三","周四","周五","周六"][e]}),n.setTime(n.getTime()+864e5)};while(n<=r)i();return a.sort((function(e,t){return e.value>t.value?1:-1})),a},greaterThanZero:function(e,t,n){Object(p["d"])(t)||n(new Error("须大于0的正整数")),n()},paginationCurrenChange:function(e){this.pagination.currentPage=e,this.doRefresh()},paginationSizeChange:function(e){this.pagination.pageSize=e,this.doRefresh()}}},f=d,h=(n("a1ac"),n("2877")),b=Object(h["a"])(f,r,a,!1,null,"77e36758",null);t["default"]=b.exports},"2c57":function(e,t,n){},"37d6":function(e,t,n){"use strict";n.d(t,"o",(function(){return a})),n.d(t,"n",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return c})),n.d(t,"z",(function(){return u})),n.d(t,"r",(function(){return m})),n.d(t,"l",(function(){return p})),n.d(t,"y",(function(){return d})),n.d(t,"v",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"m",(function(){return b})),n.d(t,"k",(function(){return v})),n.d(t,"w",(function(){return g})),n.d(t,"u",(function(){return I})),n.d(t,"g",(function(){return k})),n.d(t,"t",(function(){return D})),n.d(t,"d",(function(){return S})),n.d(t,"j",(function(){return y})),n.d(t,"i",(function(){return E})),n.d(t,"q",(function(){return x})),n.d(t,"p",(function(){return O})),n.d(t,"x",(function(){return F})),n.d(t,"s",(function(){return P})),n.d(t,"b",(function(){return T}));var r=n("b775");function a(e){return Object(r["a"])({url:"api/ExamWork/GetSupervisonrList",method:"get",params:e})}function i(e){return Object(r["a"])({url:"api/ExamWork/GetSupervisor",method:"get",params:e})}function o(e){return Object(r["a"])({url:"api/Sys/CheckUserInfo",method:"get",noNoticeError:!0,params:e})}function s(e){return Object(r["a"])({url:"api/ExamWork/AddSupervisor",method:"post",data:e})}function l(e){return Object(r["a"])({url:"api/ExamWork/DisableSupervisorInfo",method:"get",params:e})}function c(e){return Object(r["a"])({url:"api/ExamWork/EnableSupervisorInfo",method:"get",params:e})}function u(e){return Object(r["a"])({url:"api/ExamWork/UpdateSupervisor",method:"post",data:e})}function m(e){return Object(r["a"])({url:"api/ExamWork/TheoryExaminationPlans",method:"get",params:e})}function p(e){return Object(r["a"])({url:"api/ExamWork/LoadTheoryExaminationPlan",method:"get",params:e})}function d(e){return Object(r["a"])({url:"api/ExamWork/SaveTheoryExaminationPlan",method:"post",data:e})}function f(e){return Object(r["a"])({url:"api/ExamWork/SaveBatchTheoryPlan",method:"post",useJSON:!0,data:e})}function h(e){return Object(r["a"])({url:"api/ExamWork/GenerateBatchTheoryPlan",method:"post",data:e})}function b(e){return Object(r["a"])({url:"api/ExamWork/SkillsExaminationPlans",method:"get",params:e})}function v(e){return Object(r["a"])({url:"api/ExamWork/LoadSkillsExaminationPlan",method:"get",params:e})}function g(e){return Object(r["a"])({url:"api/ExamWork/SaveSkillsExaminationPlan",method:"post",data:e})}function I(e){return Object(r["a"])({url:"api/ExamWork/SaveBatchSkillsPlan",method:"post",useJSON:!0,data:e})}function k(e){return Object(r["a"])({url:"api/ExamWork/GenerateBatchSkillsPlan",method:"post",data:e})}function D(e){return Object(r["a"])({url:"api/ExamWork/ReleaseExamPlans",method:"post",data:e})}function S(e){return Object(r["a"])({url:"api/ExamWork/DeleteExamPlans",method:"post",data:e})}function y(e){return Object(r["a"])({url:"api/ExamWork/GetExamPlanOrderedDetail",method:"get",params:e})}function E(e){return Object(r["a"])({url:"api/ExamWork/GetExamPlanForSupervisionPlan",method:"get",params:e})}function x(e){return Object(r["a"])({url:"api/ExamWork/GetSupervissionPlanList",method:"get",params:e})}function O(e){return Object(r["a"])({url:"api/ExamWork/GetSupervissionPlanDetail",method:"get",params:e})}function F(e){return Object(r["a"])({url:"api/ExamWork/SaveSupervissionPlan",method:"post",data:e})}function P(e){return Object(r["a"])({url:"api/ExamWork/PublishSupervissionPlan",method:"post",useJSON:!0,data:e})}function T(e){return Object(r["a"])({url:"api/ExamWork/CancelSupervissionPlan",method:"post",useJSON:!0,data:e})}},a1ac:function(e,t,n){"use strict";var r=n("2c57"),a=n.n(r);a.a}}]);